import{r as n,c as Q,q as ve,x as o,z as e,I as W,R as fe,L as d,O as v,P as l,K as p,al as ke,aq as C,Q as f,ac as R,aW as G,a5 as X,Y as he,y as s,C as V,u as A}from"./vue-vendor-DMOLwvvm.js";import{C as we}from"./ConfirmModal-DXiBIW2b.js";import{bo as Ce,bp as _e,bq as je,br as Te,bs as Ae,s as m,bt as te,bu as Ue,bv as $e,Z as B,c as ae}from"./index-UbVhXwtH.js";import"./vendor-CSA95d8J.js";import"./element-plus-BS6u3EDt.js";const qe={class:"tab-content"},Me={class:"card p-4 sm:p-6"},Re={class:"mb-4 flex flex-col gap-4 sm:mb-6"},Ve={class:"flex items-center justify-between"},Ee={class:"grid grid-cols-2 gap-3 sm:grid-cols-4 sm:gap-4"},Le={class:"stat-card"},Se={class:"flex items-center justify-between"},De={class:"text-xl font-bold text-gray-900 dark:text-gray-100 sm:text-2xl"},Ne={class:"stat-card"},Pe={class:"flex items-center justify-between"},ze={class:"text-xl font-bold text-green-600 dark:text-green-400 sm:text-2xl"},Ie={class:"stat-card"},Qe={class:"flex items-center justify-between"},Be={class:"text-xl font-bold text-purple-600 dark:text-purple-400 sm:text-2xl"},Ke={class:"stat-card"},Oe={class:"flex items-center justify-between"},He={class:"text-xl font-bold text-red-600 dark:text-red-400 sm:text-2xl"},Fe={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},We={class:"flex flex-wrap items-center gap-4"},Ge={class:"flex items-center gap-2"},Xe={class:"relative inline-flex cursor-pointer items-center"},Ye={class:"flex items-center gap-2"},Ze=["disabled"],Je={class:"flex items-center gap-2"},et=["disabled"],tt={class:"border-b border-gray-200 dark:border-gray-700"},at={"aria-label":"Tabs",class:"-mb-px flex space-x-8"},st=["onClick"],rt={key:0,class:"flex items-center justify-center py-12"},ot={key:1,class:"overflow-x-auto"},lt={key:0,class:"mb-3 flex items-center gap-3 rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},dt={class:"text-sm text-blue-700 dark:text-blue-300"},nt={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},it={class:"bg-gray-50 dark:bg-gray-700/50"},ut={class:"w-10 px-4 py-3"},gt=["checked","indeterminate"],xt={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-800"},ct={class:"whitespace-nowrap px-4 py-3"},pt=["checked","onChange"],yt={class:"whitespace-nowrap px-4 py-3"},mt=["onClick"],bt={class:"whitespace-nowrap px-4 py-3"},vt={class:"whitespace-nowrap px-4 py-3 text-sm text-gray-900 dark:text-white"},ft={key:0},kt={key:1},ht={key:2},wt={class:"whitespace-nowrap px-4 py-3"},Ct={class:"whitespace-nowrap px-4 py-3 text-sm text-gray-500 dark:text-gray-400"},_t={class:"whitespace-nowrap px-4 py-3 text-sm text-gray-500 dark:text-gray-400"},jt={class:"whitespace-nowrap px-4 py-3 text-right"},Tt=["onClick"],At={key:0},Ut={key:1,class:"flex flex-col items-center justify-between gap-3 border-t border-gray-200 px-4 py-3 dark:border-gray-700 sm:flex-row"},$t={class:"flex items-center gap-4"},qt={class:"text-sm text-gray-600 dark:text-gray-400"},Mt={class:"flex items-center gap-2"},Rt=["value"],Vt={class:"flex items-center gap-2"},Et=["disabled"],Lt={class:"text-sm text-gray-600 dark:text-gray-400"},St=["disabled"],Dt={key:2,class:"overflow-x-auto"},Nt={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Pt={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-800"},zt={class:"whitespace-nowrap px-4 py-3"},It=["onClick"],Qt={class:"whitespace-nowrap px-4 py-3"},Bt=["onClick"],Kt={class:"whitespace-nowrap px-4 py-3"},Ot=["onClick"],Ht={class:"whitespace-nowrap px-4 py-3 text-sm text-gray-900 dark:text-white"},Ft={key:0},Wt={key:1},Gt={key:2},Xt={class:"whitespace-nowrap px-4 py-3"},Yt={class:"whitespace-nowrap px-4 py-3 text-sm text-gray-500 dark:text-gray-400"},Zt={class:"whitespace-nowrap px-4 py-3 text-right"},Jt=["onClick"],ea={key:0},ta={key:0,class:"modal fixed inset-0 z-50 flex items-center justify-center p-4"},aa={class:"modal-content mx-auto w-full max-w-lg p-6"},sa={class:"mb-6 flex items-center justify-between"},ra={class:"space-y-4"},oa={key:0},la={key:1},da={class:"flex gap-2"},na={class:"mt-6 flex gap-3"},ia=["disabled"],ua={key:0,class:"fas fa-spinner fa-spin mr-2"},ga={key:0,class:"modal fixed inset-0 z-50 flex items-center justify-center p-4"},xa={class:"modal-content mx-auto w-full max-w-lg p-6"},ca={class:"mb-6 flex items-center justify-between"},pa={class:"flex items-center gap-3"},ya={class:"text-sm text-gray-500 dark:text-gray-400"},ma={class:"mb-4 max-h-60 overflow-y-auto rounded-lg bg-gray-50 p-3 dark:bg-gray-700/50"},ba={class:"flex items-center gap-2"},va={class:"text-xs text-gray-400"},fa={class:"font-mono text-sm text-gray-900 dark:text-white"},ka={class:"text-xs text-gray-500 dark:text-gray-400"},ha={class:"w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl dark:bg-gray-800"},wa={class:"mb-4"},Ca={class:"flex justify-end gap-3"},qa={__name:"QuotaCardsView",setup(_a){const K=n(!1),U=n(!1),$=n(!1),O=n(!1),E=n(!1),_=n({title:"",message:"",type:"primary",confirmText:"Confirmar",cancelText:"Cancelar"}),k=n(null),c=n([]),q=n(!1),L=n(""),S=n(null),D=n("cards"),i=n([]),b=n(1),M=n(20),se=[10,20,50,100],N=n(0),re=[{id:"cards",name:"Lista de Tarjetas"},{id:"redemptions",name:"Registros de Canje"}],j=n({total:0,unused:0,redeemed:0,revoked:0,expired:0}),y=n({enabled:!0,maxExpiryDays:90,maxTotalCostLimit:1e3}),P=n([]),H=n([]),z=Q(()=>P.value.filter(r=>r.status==="unused")),Y=Q(()=>z.value.length>0&&i.value.length===z.value.length),oe=Q(()=>i.value.length>0&&i.value.length<z.value.length),le=()=>{Y.value?i.value=[]:i.value=z.value.map(r=>r.id)},de=r=>{const t=i.value.indexOf(r);t===-1?i.value.push(r):i.value.splice(t,1)},g=n({type:"quota",quotaAmount:10,timeAmount:30,timeUnit:"days",count:1,note:""}),Z=(r,t,a="Confirmar",u="Cancelar",T="primary")=>new Promise(x=>{_.value={title:r,message:t,confirmText:a,cancelText:u,type:T},k.value=x,E.value=!0}),ne=()=>{var r;E.value=!1,(r=k.value)==null||r.call(k,!0)},ie=()=>{var r;E.value=!1,(r=k.value)==null||r.call(k,!1)},h=async()=>{var x,w,I;K.value=!0;const r=(b.value-1)*M.value,[t,a,u]=await Promise.all([Ce({limit:M.value,offset:r}),_e(),je()]),T=await Te().catch(()=>({data:null}));P.value=((x=t.data)==null?void 0:x.cards)||[],N.value=((w=t.data)==null?void 0:w.total)||0,j.value=a.data||j.value,H.value=((I=u.data)==null?void 0:I.redemptions)||[],T.data&&(y.value=T.data),K.value=!1},F=async()=>{(await Ae(y.value)).success&&m("Configuración guardada","success")},J=Q(()=>Math.ceil(N.value/M.value)),ee=r=>{b.value=r,i.value=[],h()},ue=()=>{b.value=1,i.value=[],h()},ge=async()=>{U.value=!0;const r=await Ue(g.value);if(r.success){$.value=!1;const t=r.data;Array.isArray(t)?c.value=t:t?c.value=[t]:c.value=[],c.value.length>0&&(O.value=!0),m(`Éxito al crear ${c.value.length} tarjetas`,"success"),h()}else m(r.message||"Error al crear tarjetas","error");U.value=!1},xe=()=>{if(c.value.length===0)return;const r=c.value.map(x=>{let w="";if((x.type==="quota"||x.type==="combo")&&(w+=`$${x.quotaAmount}`),x.type==="combo"&&(w+="_"),x.type==="time"||x.type==="combo"){const I={hours:"h",days:"d",months:"m"};w+=`${x.timeAmount}${I[x.timeUnit]||x.timeUnit}`}return`${w} ${x.code}`}).join(`
`),t=new Blob([r],{type:"text/plain;charset=utf-8"}),a=URL.createObjectURL(t),u=document.createElement("a");u.href=a;const T=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);u.download=`quota-cards-${T}.txt`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(a),m("Archivo de tarjetas descargado","success")},ce=async()=>{if(c.value.length===0)return;const r=c.value.map(t=>t.code).join(`
`);try{await navigator.clipboard.writeText(r),m("Todos los números de tarjeta copiados","success")}catch(t){console.error("Failed to copy:",t),m("Error al copiar","error")}},pe=async r=>{await Z("Eliminar Tarjeta",`¿Confirmar eliminación de tarjeta ${r.code}?`,"Confirmar Eliminación","Cancelar","danger")&&(await te(r.id),m("Tarjeta eliminada","success"),h())},ye=async()=>{await Z("Eliminación en Lote",`¿Confirmar eliminación de ${i.value.length} tarjetas seleccionadas?`,"Confirmar Eliminación","Cancelar","danger")&&(await Promise.all(i.value.map(t=>te(t))),m(`${i.value.length} tarjetas eliminadas`,"success"),i.value=[],h())},me=r=>{S.value=r,L.value="",q.value=!0},be=async()=>{S.value&&(await $e(S.value.id,{reason:L.value}),m("Canje revocado","success"),q.value=!1,S.value=null,h())};return ve(()=>{h()}),(r,t)=>(s(),o("div",qe,[e("div",Me,[e("div",Re,[e("div",Ve,[t[21]||(t[21]=e("div",null,[e("h3",{class:"mb-1 text-lg font-bold text-gray-900 dark:text-gray-100 sm:mb-2 sm:text-xl"}," Administración de Tarjetas de Cuota "),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 sm:text-base"}," Administra tarjetas de cuota y tiempo, los usuarios pueden canjearlas para aumentar cuota ")],-1)),e("button",{class:"inline-flex items-center rounded-md bg-blue-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",onClick:t[0]||(t[0]=a=>$.value=!0)},t[20]||(t[20]=[e("i",{class:"fas fa-plus mr-2"},null,-1),v(" Crear Tarjeta ",-1)]))]),e("div",Ee,[e("div",Le,[e("div",Se,[e("div",null,[t[22]||(t[22]=e("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," Total de Tarjetas ",-1)),e("p",De,l(j.value.total),1)]),t[23]||(t[23]=e("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-blue-500 to-blue-600"},[e("i",{class:"fas fa-ticket-alt"})],-1))])]),e("div",Ne,[e("div",Pe,[e("div",null,[t[24]||(t[24]=e("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," Sin Usar ",-1)),e("p",ze,l(j.value.unused),1)]),t[25]||(t[25]=e("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-green-500 to-green-600"},[e("i",{class:"fas fa-check-circle"})],-1))])]),e("div",Ie,[e("div",Qe,[e("div",null,[t[26]||(t[26]=e("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," Canjeadas ",-1)),e("p",Be,l(j.value.redeemed),1)]),t[27]||(t[27]=e("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-purple-500 to-purple-600"},[e("i",{class:"fas fa-exchange-alt"})],-1))])]),e("div",Ke,[e("div",Oe,[e("div",null,[t[28]||(t[28]=e("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," Revocadas ",-1)),e("p",He,l(j.value.revoked),1)]),t[29]||(t[29]=e("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-red-500 to-red-600"},[e("i",{class:"fas fa-ban"})],-1))])])]),e("div",Fe,[e("div",We,[e("div",Ge,[t[31]||(t[31]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Protección de Límite de Canje",-1)),e("label",Xe,[p(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>y.value.enabled=a),class:"peer sr-only",type:"checkbox",onChange:F},null,544),[[ke,y.value.enabled]]),t[30]||(t[30]=e("div",{class:"peer h-5 w-9 rounded-full bg-gray-300 after:absolute after:left-[2px] after:top-[2px] after:h-4 after:w-4 after:rounded-full after:bg-white after:transition-all after:content-[''] peer-checked:bg-blue-600 peer-checked:after:translate-x-full dark:bg-gray-600"},null,-1))])]),e("div",Ye,[t[32]||(t[32]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Cuota Máxima",-1)),p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>y.value.maxTotalCostLimit=a),class:"w-24 rounded border border-gray-300 bg-white px-2 py-1 text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white",disabled:!y.value.enabled,min:"0",type:"number",onChange:F},null,40,Ze),[[C,y.value.maxTotalCostLimit,void 0,{number:!0}]]),t[33]||(t[33]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"$",-1))]),e("div",Je,[t[34]||(t[34]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Validez Máxima",-1)),p(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>y.value.maxExpiryDays=a),class:"w-20 rounded border border-gray-300 bg-white px-2 py-1 text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white",disabled:!y.value.enabled,min:"0",type:"number",onChange:F},null,40,et),[[C,y.value.maxExpiryDays,void 0,{number:!0}]]),t[35]||(t[35]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"días",-1))])])]),e("div",tt,[e("nav",at,[(s(),o(f,null,R(re,a=>e("button",{key:a.id,class:V(["whitespace-nowrap border-b-2 px-1 py-2 text-sm font-medium",D.value===a.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:border-gray-500 dark:hover:text-gray-300"]),onClick:u=>D.value=a.id},l(a.name),11,st)),64))])])]),K.value?(s(),o("div",rt,t[36]||(t[36]=[e("i",{class:"fas fa-spinner fa-spin mr-2 text-blue-500"},null,-1),e("span",{class:"text-gray-500 dark:text-gray-400"},"Cargando...",-1)]))):D.value==="cards"?(s(),o("div",ot,[i.value.length>0?(s(),o("div",lt,[e("span",dt,l(i.value.length)+" tarjetas seleccionadas ",1),e("button",{class:"rounded-lg bg-red-500 px-3 py-1.5 text-sm font-medium text-white hover:bg-red-600",onClick:ye},t[37]||(t[37]=[e("i",{class:"fas fa-trash mr-1"},null,-1),v(" Eliminar en Lote ",-1)])),e("button",{class:"rounded-lg bg-gray-200 px-3 py-1.5 text-sm font-medium text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",onClick:t[4]||(t[4]=a=>i.value=[])}," Cancelar Selección ")])):d("",!0),e("table",nt,[e("thead",it,[e("tr",null,[e("th",ut,[e("input",{checked:Y.value,class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",indeterminate:oe.value,type:"checkbox",onChange:le},null,40,gt)]),t[38]||(t[38]=e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Número ",-1)),t[39]||(t[39]=e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Tipo ",-1)),t[40]||(t[40]=e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Cuota/Tiempo ",-1)),t[41]||(t[41]=e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Estado ",-1)),t[42]||(t[42]=e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Usuario de Canje ",-1)),t[43]||(t[43]=e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Fecha de Creación ",-1)),t[44]||(t[44]=e("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Acciones ",-1))])]),e("tbody",xt,[(s(!0),o(f,null,R(P.value,a=>(s(),o("tr",{key:a.id,class:V(["hover:bg-gray-50 dark:hover:bg-gray-700/50",i.value.includes(a.id)?"bg-blue-50 dark:bg-blue-900/10":""])},[e("td",ct,[a.status==="unused"?(s(),o("input",{key:0,checked:i.value.includes(a.id),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"checkbox",onChange:u=>de(a.id)},null,40,pt)):d("",!0)]),e("td",yt,[e("code",{class:"cursor-pointer rounded bg-gray-100 px-2 py-1 font-mono text-xs hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600",title:"Haz clic para copiar",onClick:u=>A(B)(a.code)},l(a.code),9,mt)]),e("td",bt,[e("span",{class:V(["inline-flex rounded-full px-2 py-1 text-xs font-medium",a.type==="quota"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":a.type==="time"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300"])},l(a.type==="quota"?"Tarjeta de Cuota":a.type==="time"?"Tarjeta de Tiempo":"Tarjeta Combinada"),3)]),e("td",vt,[a.type==="quota"||a.type==="combo"?(s(),o("span",ft,"$"+l(a.quotaAmount),1)):d("",!0),a.type==="combo"?(s(),o("span",kt," + ")):d("",!0),a.type==="time"||a.type==="combo"?(s(),o("span",ht,l(a.timeAmount)+" "+l(a.timeUnit==="hours"?"horas":a.timeUnit==="days"?"días":"mes"),1)):d("",!0)]),e("td",wt,[e("span",{class:V(["inline-flex rounded-full px-2 py-1 text-xs font-medium",a.status==="unused"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":a.status==="redeemed"?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"])},l(a.status==="unused"?"Sin Usar":a.status==="redeemed"?"Canjada":"Revocada"),3)]),e("td",Ct,l(a.redeemedByUsername||"-"),1),e("td",_t,l(A(ae)(a.createdAt)),1),e("td",jt,[a.status==="unused"?(s(),o("button",{key:0,class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",title:"Eliminar",onClick:u=>pe(a)},t[45]||(t[45]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Tt)):d("",!0)])],2))),128)),P.value.length===0?(s(),o("tr",At,t[46]||(t[46]=[e("td",{class:"px-4 py-8 text-center text-sm text-gray-500 dark:text-gray-400",colspan:"8"}," No hay datos de tarjetas ",-1)]))):d("",!0)])]),N.value>0?(s(),o("div",Ut,[e("div",$t,[e("span",qt," Total: "+l(N.value)+" registros ",1),e("div",Mt,[t[47]||(t[47]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Por página",-1)),p(e("select",{"onUpdate:modelValue":t[5]||(t[5]=a=>M.value=a),class:"rounded-md border border-gray-200 bg-white px-2 py-1 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300",onChange:ue},[(s(),o(f,null,R(se,a=>e("option",{key:a,value:a},l(a),9,Rt)),64))],544),[[G,M.value]]),t[48]||(t[48]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"registros",-1))])]),e("div",Vt,[e("button",{class:"rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",disabled:b.value===1,onClick:t[6]||(t[6]=a=>ee(b.value-1))},t[49]||(t[49]=[e("i",{class:"fas fa-chevron-left"},null,-1)]),8,Et),e("span",Lt,l(b.value)+" / "+l(J.value),1),e("button",{class:"rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",disabled:b.value>=J.value,onClick:t[7]||(t[7]=a=>ee(b.value+1))},t[50]||(t[50]=[e("i",{class:"fas fa-chevron-right"},null,-1)]),8,St)])])):d("",!0)])):D.value==="redemptions"?(s(),o("div",Dt,[e("table",Nt,[t[53]||(t[53]=e("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Número "),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Usuario "),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," API Key "),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Cuota Añadida "),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Estado "),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Fecha de Canje "),e("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Acciones ")])],-1)),e("tbody",Pt,[(s(!0),o(f,null,R(H.value,a=>(s(),o("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[e("td",zt,[e("code",{class:"cursor-pointer rounded bg-gray-100 px-2 py-1 font-mono text-xs hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600",title:"Haz clic para copiar",onClick:u=>A(B)(a.cardCode)},l(a.cardCode),9,It)]),e("td",Qt,[e("span",{class:"cursor-pointer text-sm text-gray-900 hover:text-blue-600 dark:text-white dark:hover:text-blue-400",title:"Haz clic para copiar",onClick:u=>A(B)(a.username||a.userId)},l(a.username||a.userId),9,Bt)]),e("td",Kt,[e("span",{class:"cursor-pointer text-sm text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400",title:"Haz clic para copiar",onClick:u=>A(B)(a.apiKeyName||a.apiKeyId)},l(a.apiKeyName||a.apiKeyId),9,Ot)]),e("td",Ht,[a.quotaAdded>0?(s(),o("span",Ft,"$"+l(a.quotaAdded),1)):d("",!0),a.quotaAdded>0&&a.timeAdded>0?(s(),o("span",Wt," + ")):d("",!0),a.timeAdded>0?(s(),o("span",Gt,l(a.timeAdded)+" "+l(a.timeUnit==="hours"?"horas":a.timeUnit==="days"?"días":"mes"),1)):d("",!0)]),e("td",Xt,[e("span",{class:V(["inline-flex rounded-full px-2 py-1 text-xs font-medium",a.status==="active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"])},l(a.status==="active"?"Válido":"Revocado"),3)]),e("td",Yt,l(A(ae)(a.timestamp)),1),e("td",Zt,[a.status==="active"?(s(),o("button",{key:0,class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",title:"Revocar canje",onClick:u=>me(a)},t[51]||(t[51]=[e("i",{class:"fas fa-undo"},null,-1)]),8,Jt)):d("",!0)])]))),128)),H.value.length===0?(s(),o("tr",ea,t[52]||(t[52]=[e("td",{class:"px-4 py-8 text-center text-sm text-gray-500 dark:text-gray-400",colspan:"7"}," No hay registros de canje ",-1)]))):d("",!0)])])])):d("",!0)]),(s(),W(X,{to:"body"},[$.value?(s(),o("div",ta,[e("div",aa,[e("div",sa,[t[55]||(t[55]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600"},[e("i",{class:"fas fa-ticket-alt text-white"})]),e("h3",{class:"text-lg font-bold text-gray-900 dark:text-gray-100"},"Crear Tarjeta de Cuota")],-1)),e("button",{class:"p-1 text-gray-400 transition-colors hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",onClick:t[8]||(t[8]=a=>$.value=!1)},t[54]||(t[54]=[e("i",{class:"fas fa-times text-xl"},null,-1)]))]),e("div",ra,[e("div",null,[t[57]||(t[57]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"},"Tipo de Tarjeta",-1)),p(e("select",{"onUpdate:modelValue":t[9]||(t[9]=a=>g.value.type=a),class:"block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},t[56]||(t[56]=[e("option",{value:"quota"},"Tarjeta de Cuota",-1),e("option",{value:"time"},"Tarjeta de Tiempo",-1),e("option",{value:"combo"},"Tarjeta Combinada",-1)]),512),[[G,g.value.type]])]),g.value.type==="quota"||g.value.type==="combo"?(s(),o("div",oa,[t[58]||(t[58]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"},"Cantidad de Cuota (USD)",-1)),p(e("input",{"onUpdate:modelValue":t[10]||(t[10]=a=>g.value.quotaAmount=a),class:"block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",min:"0",step:"0.1",type:"number"},null,512),[[C,g.value.quotaAmount,void 0,{number:!0}]])])):d("",!0),g.value.type==="time"||g.value.type==="combo"?(s(),o("div",la,[t[60]||(t[60]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"},"Cantidad de Tiempo",-1)),e("div",da,[p(e("input",{"onUpdate:modelValue":t[11]||(t[11]=a=>g.value.timeAmount=a),class:"block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",min:"1",type:"number"},null,512),[[C,g.value.timeAmount,void 0,{number:!0}]]),p(e("select",{"onUpdate:modelValue":t[12]||(t[12]=a=>g.value.timeUnit=a),class:"block rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},t[59]||(t[59]=[e("option",{value:"hours"},"Horas",-1),e("option",{value:"days"},"Días",-1),e("option",{value:"months"},"Mes",-1)]),512),[[G,g.value.timeUnit]])])])):d("",!0),e("div",null,[t[61]||(t[61]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"},"Cantidad de Generación por Lote",-1)),p(e("input",{"onUpdate:modelValue":t[13]||(t[13]=a=>g.value.count=a),class:"block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",max:"100",min:"1",type:"number"},null,512),[[C,g.value.count,void 0,{number:!0}]])]),e("div",null,[t[62]||(t[62]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"},"Nota (opcional)",-1)),p(e("input",{"onUpdate:modelValue":t[14]||(t[14]=a=>g.value.note=a),class:"block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"Ejemplo: Tarjeta promocional de Año Nuevo",type:"text"},null,512),[[C,g.value.note]])])]),e("div",na,[e("button",{class:"flex-1 rounded-xl bg-gray-100 px-4 py-2.5 font-medium text-gray-700 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",type:"button",onClick:t[15]||(t[15]=a=>$.value=!1)}," Cancelar "),e("button",{class:"flex-1 rounded-xl bg-gradient-to-r from-blue-500 to-blue-600 px-4 py-2.5 font-medium text-white shadow-sm transition-colors hover:from-blue-600 hover:to-blue-700 disabled:opacity-50",disabled:U.value,type:"button",onClick:ge},[U.value?(s(),o("i",ua)):d("",!0),v(" "+l(U.value?"Creando...":"Crear"),1)],8,ia)])])])):d("",!0)])),(s(),W(X,{to:"body"},[O.value?(s(),o("div",ga,[e("div",xa,[e("div",ca,[e("div",pa,[t[64]||(t[64]=e("div",{class:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-green-500 to-green-600"},[e("i",{class:"fas fa-check text-white"})],-1)),e("div",null,[t[63]||(t[63]=e("h3",{class:"text-lg font-bold text-gray-900 dark:text-gray-100"},"Creación Exitosa",-1)),e("p",ya,l(c.value.length)+" tarjetas creadas ",1)])]),e("button",{class:"p-1 text-gray-400 transition-colors hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",onClick:t[16]||(t[16]=a=>O.value=!1)},t[65]||(t[65]=[e("i",{class:"fas fa-times text-xl"},null,-1)]))]),e("div",ma,[(s(!0),o(f,null,R(c.value,(a,u)=>(s(),o("div",{key:a.id,class:"flex items-center justify-between border-b border-gray-200 py-2 last:border-0 dark:border-gray-600"},[e("div",ba,[e("span",va,l(u+1)+".",1),e("code",fa,l(a.code),1)]),e("span",ka,[a.type==="quota"||a.type==="combo"?(s(),o(f,{key:0},[v(" $"+l(a.quotaAmount),1)],64)):d("",!0),a.type==="combo"?(s(),o(f,{key:1},[v(" + ")],64)):d("",!0),a.type==="time"||a.type==="combo"?(s(),o(f,{key:2},[v(l(a.timeAmount)+" "+l(a.timeUnit==="hours"?"horas":a.timeUnit==="days"?"días":"mes"),1)],64)):d("",!0)])]))),128))]),t[68]||(t[68]=e("div",{class:"mb-4 rounded-lg border border-yellow-200 bg-yellow-50 p-3 dark:border-yellow-700 dark:bg-yellow-900/20"},[e("div",{class:"flex items-start gap-2"},[e("i",{class:"fas fa-exclamation-triangle mt-0.5 text-yellow-500"}),e("p",{class:"text-sm text-yellow-700 dark:text-yellow-300"}," Descargue o copie los números de tarjeta inmediatamente, no podrá volver a ver la lista completa después de cerrar. ")])],-1)),e("div",{class:"flex gap-3"},[e("button",{class:"flex-1 rounded-xl bg-gradient-to-r from-blue-500 to-blue-600 px-4 py-2.5 font-medium text-white shadow-sm transition-colors hover:from-blue-600 hover:to-blue-700",type:"button",onClick:xe},t[66]||(t[66]=[e("i",{class:"fas fa-download mr-2"},null,-1),v(" Descargar TXT ",-1)])),e("button",{class:"flex-1 rounded-xl bg-gray-100 px-4 py-2.5 font-medium text-gray-700 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",type:"button",onClick:ce},t[67]||(t[67]=[e("i",{class:"fas fa-copy mr-2"},null,-1),v(" Copiar Todo ",-1)]))])])])):d("",!0)])),(s(),W(X,{to:"body"},[q.value?(s(),o("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4 backdrop-blur-sm",onClick:t[19]||(t[19]=he(a=>q.value=!1,["self"]))},[e("div",ha,[t[70]||(t[70]=e("h3",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-white"},"Revocar Canje",-1)),e("div",wa,[t[69]||(t[69]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Motivo de Revocación (opcional) ",-1)),p(e("input",{"onUpdate:modelValue":t[17]||(t[17]=a=>L.value=a),class:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"Ingrese el motivo de la revocación",type:"text"},null,512),[[C,L.value]])]),e("div",Ca,[e("button",{class:"rounded-lg bg-gray-100 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",onClick:t[18]||(t[18]=a=>q.value=!1)}," Cancelar "),e("button",{class:"rounded-lg bg-red-500 px-4 py-2 text-sm font-medium text-white hover:bg-red-600",onClick:be}," Confirmar Revocación ")])])])):d("",!0)])),fe(we,{"cancel-text":_.value.cancelText,"confirm-text":_.value.confirmText,message:_.value.message,show:E.value,title:_.value.title,type:_.value.type,onCancel:ie,onConfirm:ne},null,8,["cancel-text","confirm-text","message","show","title","type"])]))}};export{qa as default};
