import{E as Xt}from"./element-plus-BS6u3EDt.js";import{aP as te,r as S,c as jt,aU as ee,a_ as Yt,o as pt,q as ae,D as nt,V as se,x as h,z as t,P as a,u as e,L as A,O as I,C as W,Q as Mt,ac as Ot,R as oe,K as ne,al as re,y as v,B as le}from"./vue-vendor-DMOLwvvm.js";import{C as Ft}from"./chart-kE0mBtKa.js";import{n as ie,o as Wt,p as Kt,s as Lt,_ as ce,a as de,f as O,q as ue}from"./index-CRxSkjgZ.js";import"./vendor-CSA95d8J.js";const me=te("dashboard",()=>{const $t=S(!1),gt=S({totalApiKeys:0,activeApiKeys:0,totalAccounts:0,normalAccounts:0,abnormalAccounts:0,pausedAccounts:0,activeAccounts:0,rateLimitedAccounts:0,accountsByPlatform:{claude:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},"claude-console":{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},gemini:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},azure_openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},bedrock:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0}},todayRequests:0,totalRequests:0,todayTokens:0,todayInputTokens:0,todayOutputTokens:0,totalTokens:0,totalInputTokens:0,totalOutputTokens:0,totalCacheCreateTokens:0,totalCacheReadTokens:0,todayCacheCreateTokens:0,todayCacheReadTokens:0,systemRPM:0,systemTPM:0,realtimeRPM:0,realtimeTPM:0,metricsWindow:5,isHistoricalMetrics:!1,systemStatus:"Ê≠£Â∏∏",uptime:0,systemTimezone:8}),V=S({todayCosts:{totalCost:0,formatted:{totalCost:"$0.000000"}},totalCosts:{totalCost:0,formatted:{totalCost:"$0.000000"}}}),l=S([]),rt=S([]),o=S({data:[],topApiKeys:[],totalApiKeys:0}),Ct=S({data:[],topAccounts:[],totalAccounts:0,group:"claude",groupLabel:"ClaudeË¥¶Êà∑"}),Z={preset:"dashboard:date:preset",granularity:"dashboard:trend:granularity"},lt="today",E="day",F=c=>c==="hour"?[{value:"last24h",label:"Ëøë24Â∞èÊó∂",hours:24},{value:"yesterday",label:"Êò®Â§©",hours:24},{value:"dayBefore",label:"ÂâçÂ§©",hours:24}]:[{value:"today",label:"‰ªäÊó•",days:1},{value:"7days",label:"7Â§©",days:7},{value:"30days",label:"30Â§©",days:30}],wt=(c,p)=>{try{return localStorage.getItem(c)||p}catch{return p}},At=(c,p)=>{try{localStorage.setItem(c,p)}catch{}},et=(c,p)=>F(p).some(f=>f.value===c)?c:p==="hour"?"last24h":lt,Q=wt(Z.granularity,E),j=["day","hour"].includes(Q)?Q:E,qt=et(wt(Z.preset,lt),j),n=S({type:"preset",preset:qt,customStart:"",customEnd:"",customRange:null,presetOptions:F(j)}),K=S(j),Rt=S("requests"),it=S("claude"),Et=jt(()=>{const c=gt.value.uptime,p=Math.floor(c/86400),r=Math.floor(c%86400/3600),i=Math.floor(c%3600/60);return p>0?`${p}Â§© ${r}Â∞èÊó∂`:r>0?`${r}Â∞èÊó∂ ${i}ÂàÜÈíü`:`${i}ÂàÜÈíü`});function H(c,p=!0){const r=c.getFullYear(),i=c.getMonth(),f=c.getDate();return p?new Date(Date.UTC(r,i,f-1,16,0,0,0)):new Date(Date.UTC(r,i,f,15,59,59,999))}function ct(c){const p=new Date;switch(c){case"today":return{start:H(p,!0),end:H(p,!1)};case"last24h":return{start:new Date(p.getTime()-24*60*60*1e3),end:new Date(p)};case"yesterday":{const r=new Date;return r.setDate(r.getDate()-1),{start:H(r,!0),end:H(r,!1)}}case"dayBefore":{const r=new Date;return r.setDate(r.getDate()-2),{start:H(r,!0),end:H(r,!1)}}default:return{start:new Date(p.getTime()-24*60*60*1e3),end:new Date(p)}}}const yt=(c=n.value.preset,p=K.value)=>{At(Z.preset,c),At(Z.granularity,p)},J=()=>n.value.type==="preset"&&n.value.preset==="today"&&K.value==="day"?"hour":K.value;async function Dt(c=null){$t.value=!0;try{let p={today:"today",all:"all"};c&&(p={today:{today:"today",all:"today"},"7days":{today:"7days",all:"7days"},monthly:{today:"monthly",all:"monthly"},all:{today:"today",all:"all"}}[c]||p);const[r,i,f]=await Promise.all([ie(),Wt(p.today),Wt(p.all)]);if(r.success){const m=r.data.overview||{},C=r.data.recentActivity||{},w=r.data.systemAverages||{},D=r.data.realtimeMetrics||{},P=r.data.systemHealth||{};gt.value={totalApiKeys:m.totalApiKeys||0,activeApiKeys:m.activeApiKeys||0,totalAccounts:m.totalAccounts||m.totalClaudeAccounts||0,normalAccounts:m.normalAccounts||0,abnormalAccounts:m.abnormalAccounts||0,pausedAccounts:m.pausedAccounts||0,activeAccounts:m.activeAccounts||m.activeClaudeAccounts||0,rateLimitedAccounts:m.rateLimitedAccounts||m.rateLimitedClaudeAccounts||0,accountsByPlatform:m.accountsByPlatform||{claude:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},"claude-console":{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},gemini:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},azure_openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},bedrock:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0}},todayRequests:C.requestsToday||0,totalRequests:m.totalRequestsUsed||0,todayTokens:C.tokensToday||0,todayInputTokens:C.inputTokensToday||0,todayOutputTokens:C.outputTokensToday||0,totalTokens:m.totalTokensUsed||0,totalInputTokens:m.totalInputTokensUsed||0,totalOutputTokens:m.totalOutputTokensUsed||0,totalCacheCreateTokens:m.totalCacheCreateTokensUsed||0,totalCacheReadTokens:m.totalCacheReadTokensUsed||0,todayCacheCreateTokens:C.cacheCreateTokensToday||0,todayCacheReadTokens:C.cacheReadTokensToday||0,systemRPM:w.rpm||0,systemTPM:w.tpm||0,realtimeRPM:D.rpm||0,realtimeTPM:D.tpm||0,metricsWindow:D.windowMinutes||5,isHistoricalMetrics:D.isHistorical||!1,systemStatus:P.redisConnected?"Ê≠£Â∏∏":"ÂºÇÂ∏∏",uptime:P.uptime||0,systemTimezone:r.data.systemTimezone||8}}i.success&&f.success&&(V.value={todayCosts:i.data.totalCosts||{totalCost:0,formatted:{totalCost:"$0.000000"}},totalCosts:f.data.totalCosts||{totalCost:0,formatted:{totalCost:"$0.000000"}}})}catch(p){console.error("Âä†ËΩΩ‰ª™Ë°®ÊùøÊï∞ÊçÆÂ§±Ë¥•:",p)}finally{$t.value=!1}}async function xt(c=7,p=J()){try{let r="/admin/usage-trend?";if(p==="hour")if(r+="granularity=hour",n.value.customRange&&n.value.customRange.length===2)r+=`&startDate=${encodeURIComponent(n.value.customRange[0])}`,r+=`&endDate=${encodeURIComponent(n.value.customRange[1])}`;else if(n.value.type==="preset"){const{start:f,end:m}=ct(n.value.preset);r+=`&startDate=${encodeURIComponent(f.toISOString())}`,r+=`&endDate=${encodeURIComponent(m.toISOString())}`}else{const f=new Date;r+=`&startDate=${encodeURIComponent(new Date(f.getTime()-c*24*60*60*1e3).toISOString())}`,r+=`&endDate=${encodeURIComponent(f.toISOString())}`}else r+=`granularity=day&days=${c}`;const i=await Kt(r);i.success&&(l.value=i.data)}catch(r){console.error("Âä†ËΩΩ‰ΩøÁî®Ë∂ãÂäøÂ§±Ë¥•:",r)}}async function ft(c="daily",p=null){const r=p||J();try{let i=`/admin/model-stats?period=${c}`;if(n.value.type==="custom"||r==="hour"){if(n.value.customRange&&n.value.customRange.length===2)i+=`&startDate=${encodeURIComponent(n.value.customRange[0])}`,i+=`&endDate=${encodeURIComponent(n.value.customRange[1])}`;else if(r==="hour"&&n.value.type==="preset"){const{start:m,end:C}=ct(n.value.preset);i+=`&startDate=${encodeURIComponent(m.toISOString())}`,i+=`&endDate=${encodeURIComponent(C.toISOString())}`}}else if(n.value.type==="preset"&&r==="day"){const m=new Date,C=n.value.presetOptions.find(w=>w.value===n.value.preset);if(C){let w,D;if(n.value.preset==="today")w=H(m,!0),D=H(m,!1);else{const P=new Date;P.setDate(P.getDate()-(C.days-1)),w=H(P,!0),D=H(m,!1)}i+=`&startDate=${encodeURIComponent(w.toISOString())}`,i+=`&endDate=${encodeURIComponent(D.toISOString())}`}}const f=await Kt(i);f.success&&(rt.value=f.data)}catch(i){console.error("Âä†ËΩΩÊ®°ÂûãÁªüËÆ°Â§±Ë¥•:",i)}}async function X(c="requests",p=null){const r=p||J();try{let i="/admin/api-keys-usage-trend?",f=7;if(r==="hour")if(i+="granularity=hour",n.value.customRange&&n.value.customRange.length===2)i+=`&startDate=${encodeURIComponent(n.value.customRange[0])}`,i+=`&endDate=${encodeURIComponent(n.value.customRange[1])}`;else if(n.value.type==="preset"){const{start:C,end:w}=ct(n.value.preset);i+=`&startDate=${encodeURIComponent(C.toISOString())}`,i+=`&endDate=${encodeURIComponent(w.toISOString())}`}else{const C=new Date;i+=`&startDate=${encodeURIComponent(new Date(C.getTime()-24*60*60*1e3).toISOString())}`,i+=`&endDate=${encodeURIComponent(C.toISOString())}`}else f=n.value.type==="preset"?n.value.preset==="today"?1:n.value.preset==="7days"?7:30:ot(n.value.customStart,n.value.customEnd),i+=`granularity=day&days=${f}`;i+=`&metric=${c}`;const m=await Kt(i);m.success&&(o.value={data:m.data||[],topApiKeys:m.topApiKeys||[],totalApiKeys:m.totalApiKeys||0})}catch(i){console.error("Âä†ËΩΩAPI KeysË∂ãÂäøÂ§±Ë¥•:",i)}}async function Y(c=it.value,p=null){const r=p||J();try{let i="/admin/account-usage-trend?",f=7;if(r==="hour")if(i+="granularity=hour",n.value.customRange&&n.value.customRange.length===2)i+=`&startDate=${encodeURIComponent(n.value.customRange[0])}`,i+=`&endDate=${encodeURIComponent(n.value.customRange[1])}`;else if(n.value.type==="preset"){const{start:C,end:w}=ct(n.value.preset);i+=`&startDate=${encodeURIComponent(C.toISOString())}`,i+=`&endDate=${encodeURIComponent(w.toISOString())}`}else{const C=new Date;i+=`&startDate=${encodeURIComponent(new Date(C.getTime()-24*60*60*1e3).toISOString())}`,i+=`&endDate=${encodeURIComponent(C.toISOString())}`}else f=n.value.type==="preset"?n.value.preset==="today"?1:n.value.preset==="7days"?7:30:ot(n.value.customStart,n.value.customEnd),i+=`granularity=day&days=${f}`;i+=`&group=${c}`;const m=await Kt(i);m.success&&(Ct.value={data:m.data||[],topAccounts:m.topAccounts||[],totalAccounts:m.totalAccounts||0,group:m.group||c,groupLabel:m.groupLabel||""})}catch(i){console.error("Âä†ËΩΩË¥¶Âè∑‰ΩøÁî®Ë∂ãÂäøÂ§±Ë¥•:",i)}}function z(c,p={}){const{silent:r=!1,skipSave:i=!1}=p,f=et(c,K.value);n.value.type="preset",n.value.preset=f;const m=n.value.presetOptions.find(U=>U.value===f),C=new Date;let w,D;if(K.value==="hour"){const U=ct(f);w=U.start,D=U.end}else w=new Date(C),D=new Date(C),f==="today"?(w.setHours(0,0,0,0),D.setHours(23,59,59,999)):m!=null&&m.days&&(w.setDate(C.getDate()-(m.days-1)),w.setHours(0,0,0,0),D.setHours(23,59,59,999));const P=U=>{const u=new Date(U),ht=u.getFullYear(),Pt=String(u.getMonth()+1).padStart(2,"0"),vt=String(u.getDate()).padStart(2,"0"),bt=String(u.getHours()).padStart(2,"0"),ut=String(u.getMinutes()).padStart(2,"0"),Ut=String(u.getSeconds()).padStart(2,"0");return`${ht}-${Pt}-${vt} ${bt}:${ut}:${Ut}`};n.value.customStart=w?w.toISOString().split("T")[0]:"",n.value.customEnd=D?D.toISOString().split("T")[0]:"",n.value.customRange=w&&D?[P(w),P(D)]:null,i||yt(n.value.preset,K.value),r||st()}function at(c){if(c&&c.length===2){n.value.type="custom",n.value.preset="",n.value.customRange=c,n.value.customStart=c[0].split(" ")[0],n.value.customEnd=c[1].split(" ")[0];const p=f=>{const[m,C]=f.split(" "),[w,D,P]=m.split("-").map(Number),[U,u,ht]=C.split(":").map(Number);return new Date(w,D-1,P,U,u,ht)},r=p(c[0]),i=p(c[1]);if(K.value==="hour"){if((i-r)/36e5>24){Lt("Â∞èÊó∂Á≤íÂ∫¶‰∏ãÊó•ÊúüËåÉÂõ¥‰∏çËÉΩË∂ÖËøá24Â∞èÊó∂","warning");return}}else if(Math.ceil((i-r)/864e5)+1>31){Lt("Êó•ÊúüËåÉÂõ¥‰∏çËÉΩË∂ÖËøá 31 Â§©","warning");return}st()}else c===null&&z(K.value==="hour"?"last24h":lt)}function zt(c,p={}){const{silent:r=!1,skipSave:i=!1,presetOverride:f}=p;if(K.value=c,c==="hour"){if(n.value.presetOptions=F("hour"),n.value.type==="custom"&&n.value.customRange&&n.value.customRange.length===2){const C=new Date(n.value.customRange[0]);if((new Date(n.value.customRange[1])-C)/(1e3*60*60)>24){Lt("Â∞èÊó∂Á≤íÂ∫¶‰∏ãÊó•ÊúüËåÉÂõ¥‰∏çËÉΩË∂ÖËøá24Â∞èÊó∂ÔºåÂ∑≤ÂàáÊç¢Âà∞Ëøë24Â∞èÊó∂","warning"),z("last24h",{silent:r,skipSave:i});return}}}else n.value.presetOptions=F("day");if(n.value.type==="custom"){i||yt(n.value.preset||lt,K.value),r||st();return}const m=f||et(n.value.preset,K.value);z(m,{silent:!0,skipSave:!0}),i||yt(n.value.preset,K.value),r||st()}async function st(){let c,p="monthly";const r=J();if(n.value.type==="preset"){const i=n.value.presetOptions.find(f=>f.value===n.value.preset);r==="hour"?(c=1,p="daily"):(c=i?i.days:7,n.value.preset==="today"?p="daily":p="monthly")}else{if(r==="hour"){const i=new Date(n.value.customRange[0]),f=new Date(n.value.customRange[1]),m=Math.ceil((f-i)/(1e3*60*60));c=Math.ceil(m/24)||1}else c=ot(n.value.customStart,n.value.customEnd);p="daily"}await Promise.all([xt(c,r),ft(p,r),X(Rt.value,r),Y(it.value,r)])}function dt(c){return it.value=c,Y(c,J())}function ot(c,p){if(!c||!p)return 7;const r=new Date(c),i=new Date(p),f=Math.abs(i-r);return Math.ceil(f/(1e3*60*60*24))||7}function It(c){return c>new Date}return z(n.value.preset,{silent:!0,skipSave:!0}),yt(n.value.preset,K.value),{loading:$t,dashboardData:gt,costsData:V,trendData:l,dashboardModelStats:rt,apiKeysTrendData:o,accountUsageTrendData:Ct,dateFilter:n,trendGranularity:K,apiKeysTrendMetric:Rt,accountUsageGroup:it,formattedUptime:Et,loadDashboardData:Dt,loadUsageTrend:xt,loadModelStats:ft,loadApiKeysTrend:X,loadAccountUsageTrend:Y,setDateFilterPreset:z,onCustomDateRangeChange:at,setTrendGranularity:zt,refreshChartsData:st,setAccountUsageGroup:dt,disabledDate:It}}),pe={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6 lg:grid-cols-4"},ge={class:"stat-card"},ye={class:"flex items-center justify-between"},xe={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},fe={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},he={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ve={class:"stat-card"},be={class:"flex items-center justify-between"},_e={class:"flex-1"},ke={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},Ce={class:"flex flex-wrap items-baseline gap-x-2"},we={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},De={key:0,class:"flex items-center gap-2"},Te=["title"],Se={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},$e=["title"],Ae={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Re=["title"],Ie={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Pe=["title"],Ue={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Be=["title"],Me={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Oe=["title"],Fe={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Ke=["title"],Le={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},qe={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Ee={key:0,class:"text-red-600"},ze={key:1,class:"text-gray-600 dark:text-gray-400"},Ge={key:2,class:"text-yellow-600"},je={class:"stat-card"},He={class:"flex items-center justify-between"},Ne={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},Ve={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},Ye={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},We={class:"stat-card"},Ze={class:"flex items-center justify-between"},Qe={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},Je={class:"text-2xl font-bold text-green-600 sm:text-3xl"},Xe={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ta={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ea={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6"},aa={class:"stat-card"},sa={class:"flex items-center justify-between"},oa={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},na={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ra={class:"mt-3 flex items-center justify-between gap-3"},la={class:"text-xs text-gray-500 dark:text-gray-400"},ia=["disabled"],ca={class:"card p-4 sm:p-6"},da={class:"mb-3 flex items-center justify-between"},ua={class:"text-xs text-gray-500 dark:text-gray-400"},ma={key:0,class:"py-6 text-center text-sm text-gray-500 dark:text-gray-400"},pa={key:1,class:"py-6 text-center text-sm text-green-600 dark:text-green-400"},ga={key:2,class:"max-h-64 space-y-2 overflow-y-auto"},ya={class:"flex items-center justify-between gap-2"},xa={class:"truncate text-sm font-medium text-gray-900 dark:text-gray-100"},fa={class:"rounded bg-gray-100 px-2 py-0.5 text-xs text-gray-600 dark:bg-gray-700 dark:text-gray-300"},ha={class:"mt-1 text-xs text-gray-600 dark:text-gray-400"},va={key:0},ba={key:1},_a={key:0,class:"mt-2"},ka={class:"mb-1 flex items-center justify-between text-xs text-gray-600 dark:text-gray-400"},Ca={class:"text-red-600 dark:text-red-400"},wa={class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},Da={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6 lg:grid-cols-4"},Ta={class:"stat-card"},Sa={class:"flex items-center justify-between"},$a={class:"mr-8 flex-1"},Aa={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},Ra={class:"mb-2 flex flex-wrap items-baseline gap-2"},Ia={class:"text-xl font-bold text-blue-600 sm:text-2xl md:text-3xl"},Pa={class:"text-sm font-medium text-green-600"},Ua={class:"text-xs text-gray-500 dark:text-gray-400"},Ba={class:"flex flex-wrap items-center justify-between gap-x-4"},Ma={class:"font-medium"},Oa={class:"font-medium"},Fa={key:0,class:"text-purple-600"},Ka={class:"font-medium"},La={key:1,class:"text-purple-600"},qa={class:"font-medium"},Ea={class:"stat-card"},za={class:"flex items-center justify-between"},Ga={class:"mr-8 flex-1"},ja={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},Ha={class:"mb-2 flex flex-wrap items-baseline gap-2"},Na={class:"text-xl font-bold text-emerald-600 sm:text-2xl md:text-3xl"},Va={class:"text-sm font-medium text-green-600"},Ya={class:"text-xs text-gray-500 dark:text-gray-400"},Wa={class:"flex flex-wrap items-center justify-between gap-x-4"},Za={class:"font-medium"},Qa={class:"font-medium"},Ja={key:0,class:"text-purple-600"},Xa={class:"font-medium"},ts={key:1,class:"text-purple-600"},es={class:"font-medium"},as={class:"stat-card"},ss={class:"flex items-center justify-between"},os={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},ns={class:"text-xs text-gray-400"},rs={class:"text-2xl font-bold text-orange-600 sm:text-3xl"},ls={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},is={key:0,class:"text-yellow-600"},cs={class:"stat-card"},ds={class:"flex items-center justify-between"},us={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},ms={class:"text-xs text-gray-400"},ps={class:"text-2xl font-bold text-rose-600 sm:text-3xl"},gs={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ys={key:0,class:"text-yellow-600"},xs={class:"mb-8"},fs={class:"mb-4 flex flex-col gap-4 sm:mb-6"},hs={class:"text-lg font-bold text-gray-900 dark:text-gray-100 sm:text-xl"},vs={class:"flex flex-col gap-2 lg:flex-row lg:items-center lg:justify-end"},bs={class:"flex flex-shrink-0 gap-1 overflow-x-auto rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},_s=["onClick"],ks={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},Cs={class:"flex items-center gap-2"},ws={key:0,class:"text-xs text-orange-600"},Ds={class:"flex items-center gap-2"},Ts={class:"flex items-center rounded-lg bg-gray-100 px-3 py-1 dark:bg-gray-700"},Ss={class:"relative inline-flex cursor-pointer items-center"},$s={class:"ml-2.5 flex select-none items-center gap-1 text-sm font-medium text-gray-600 dark:text-gray-300"},As=["disabled","title"],Rs={class:"hidden sm:inline"},Is={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},Ps={class:"card p-4 sm:p-6"},Us={class:"mb-4 text-base font-semibold text-gray-800 dark:text-gray-200 sm:text-lg"},Bs={class:"relative",style:{height:"250px"}},Ms={class:"card p-4 sm:p-6"},Os={class:"mb-4 text-base font-semibold text-gray-800 dark:text-gray-200 sm:text-lg"},Fs={key:0,class:"py-8 text-center"},Ks={class:"text-sm text-gray-500 sm:text-base"},Ls={key:1,class:"max-h-[250px] overflow-auto sm:max-h-[300px]"},qs={class:"min-w-full"},Es={class:"sticky top-0 bg-gray-50 dark:bg-gray-700"},zs={class:"px-2 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"},Gs={class:"hidden px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:table-cell sm:px-4"},js={class:"px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"},Hs={class:"px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"},Ns={class:"hidden px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:table-cell sm:px-4"},Vs={class:"divide-y divide-gray-200 dark:divide-gray-600"},Ys={class:"px-2 py-2 text-xs text-gray-900 dark:text-gray-100 sm:px-4 sm:text-sm"},Ws=["title"],Zs={class:"hidden px-2 py-2 text-right text-xs text-gray-600 dark:text-gray-400 sm:table-cell sm:px-4 sm:text-sm"},Qs={class:"px-2 py-2 text-right text-xs text-gray-600 dark:text-gray-400 sm:px-4 sm:text-sm"},Js={class:"px-2 py-2 text-right text-xs font-medium text-green-600 sm:px-4 sm:text-sm"},Xs={class:"hidden px-2 py-2 text-right text-xs font-medium sm:table-cell sm:px-4 sm:text-sm"},to={class:"inline-flex items-center rounded-full bg-blue-100 px-2 py-1 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"},eo={class:"mb-4 sm:mb-6 md:mb-8"},ao={class:"card p-4 sm:p-6"},so={class:"mb-3 flex items-center justify-between"},oo={class:"text-xs font-semibold text-gray-700 dark:text-gray-300 sm:text-sm"},no=["disabled"],ro={class:"sm:h-[300px]",style:{height:"250px"}},lo={class:"mb-4 sm:mb-6 md:mb-8"},io={class:"card p-4 sm:p-6"},co={class:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},uo={class:"text-base font-semibold text-gray-900 dark:text-gray-100 sm:text-lg"},mo={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},po={class:"hidden sm:inline"},go={class:"sm:hidden"},yo={class:"hidden sm:inline"},xo={class:"sm:hidden"},fo={class:"mb-4 text-xs text-gray-600 dark:text-gray-400 sm:text-sm"},ho={key:0},vo={key:1},bo={class:"sm:h-[350px]",style:{height:"300px"}},_o={class:"mb-4 sm:mb-6 md:mb-8"},ko={class:"card p-4 sm:p-6"},Co={class:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},wo={class:"flex flex-col gap-1 sm:flex-row sm:items-center sm:gap-3"},Do={class:"text-base font-semibold text-gray-900 dark:text-gray-100 sm:text-lg"},To={class:"text-xs text-gray-500 dark:text-gray-400 sm:text-sm"},So={class:"flex flex-wrap items-center gap-2"},$o={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},Ao=["onClick"],Ro={class:"mb-4 flex flex-wrap items-center gap-2 text-xs text-gray-600 dark:text-gray-400 sm:text-sm"},Io={key:0},Po={key:0,class:"py-12 text-center text-sm text-gray-500 dark:text-gray-400"},Uo={key:1,class:"sm:h-[350px]",style:{height:"300px"}},Bo={__name:"DashboardView",setup($t){const gt=me(),V=de(),{t:l}=ee(),{isDarkMode:rt}=Yt(V),{dashboardData:o,costsData:Ct,dashboardModelStats:Z,trendData:lt,apiKeysTrendData:E,accountUsageTrendData:F,accountUsageGroup:wt,formattedUptime:At,dateFilter:et,trendGranularity:Q,apiKeysTrendMetric:j}=Yt(gt),{loadDashboardData:qt,loadApiKeysTrend:n,setDateFilterPreset:K,onCustomDateRangeChange:Rt,setTrendGranularity:it,refreshChartsData:Et,setAccountUsageGroup:H,disabledDate:ct}=gt,yt=[new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)],J=S(null),Dt=S(null),xt=S(null),ft=S(null);let X=null,Y=null,z=null,at=null;const zt=[{value:"claude",label:"Claude"},{value:"openai",label:"OpenAI"},{value:"gemini",label:"Gemini"},{value:"droid",label:"Droid"}],st=S(!1),dt=S({totalBalance:0,totalCost:0,lowBalanceCount:0,platforms:{}}),ot=S(!1),It=S(null),c=g=>({claude:"Claude","claude-console":"Claude Console",gemini:"Gemini","gemini-api":"Gemini API",openai:"OpenAI","openai-responses":"OpenAI Responses",azure_openai:"Azure OpenAI",bedrock:"Bedrock",droid:"Droid",ccr:"CCR"})[g]||g,p=jt(()=>{var T;const g=[],s=((T=dt.value)==null?void 0:T.platforms)||{};return Object.entries(s).forEach(([x,B])=>{(Array.isArray(B==null?void 0:B.accounts)?B.accounts:[]).forEach(G=>{var k,_;const q=G==null?void 0:G.data;if(!q)return;const b=(k=q.balance)==null?void 0:k.amount,R=(_=q.quota)==null?void 0:_.percentage,y=typeof b=="number"&&b<10,d=typeof R=="number"&&R>90;(y||d)&&g.push({...q,name:(G==null?void 0:G.name)||q.accountId,platform:q.platform||x})})}),g}),r=g=>{const s=Number(g);return Number.isFinite(s)?s>=1?`$${s.toFixed(2)}`:s>=.01?`$${s.toFixed(3)}`:`$${s.toFixed(6)}`:"$0.00"},i=g=>{if(!g)return"Êú™Áü•";const s=new Date(g);return Number.isNaN(s.getTime())?"Êú™Áü•":s.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})},f=async()=>{ot.value=!0;const g=await ue();g!=null&&g.success?(dt.value=g.data||{totalBalance:0,totalCost:0,lowBalanceCount:0,platforms:{}},It.value=new Date().toISOString()):g!=null&&g.message&&(console.debug("Âä†ËΩΩ‰ΩôÈ¢ùÊ±áÊÄªÂ§±Ë¥•:",g.message),Lt("Âä†ËΩΩ‰ΩôÈ¢ùÊ±áÊÄªÂ§±Ë¥•","error")),ot.value=!1},m=S(!1),C=S(30),w=S(null),D=S(0),P=S(null),U=S(!1),u=jt(()=>({text:rt.value?"#e5e7eb":"#374151",grid:rt.value?"rgba(75, 85, 99, 0.3)":"rgba(0, 0, 0, 0.1)",legend:rt.value?"#e5e7eb":"#374151"}));function ht(g){return Number.isFinite(g)?g>=1?`$${g.toFixed(2)}`:g>=.01?`$${g.toFixed(3)}`:`$${g.toFixed(6)}`:"$0.000000"}function Pt(g,s){if(!s||s.length===0)return 0;const T=s.reduce((x,B)=>x+B.allTokens,0);return T===0?0:(g/T*100).toFixed(1)}function vt(){if(!J.value)return;const g=Z.value||[],s={labels:g.map(T=>T.model),datasets:[{data:g.map(T=>T.allTokens),backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#84CC16"],borderWidth:0}]};if(X){X.data=s,X.options.plugins.legend.labels.color=u.value.legend,X.update("none");return}X=new Ft(J.value,{type:"doughnut",data:s,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,usePointStyle:!0,font:{size:12},color:u.value.legend}},tooltip:{callbacks:{label:function(T){const x=T.label||"",B=O(T.parsed),tt=Pt(T.parsed,g);return`${x}: ${B} (${tt}%)`}}}}}})}function bt(){var y;if(!Dt.value)return;const g=lt.value||[],s=g.map(d=>d.inputTokens||0),T=g.map(d=>d.outputTokens||0),x=g.map(d=>d.cacheCreateTokens||0),B=g.map(d=>d.cacheReadTokens||0),tt=g.map(d=>d.requests||0),G=g.map(d=>d.cost||0),q=(y=g[0])!=null&&y.date?"date":"hour",R={labels:g.map(d=>{if(d.label)return d.label;if(q==="hour"){const _=new Date(d.hour),$=String(_.getMonth()+1).padStart(2,"0"),N=String(_.getDate()).padStart(2,"0"),L=String(_.getHours()).padStart(2,"0");return`${$}/${N} ${L}:00`}const k=d.date;if(k&&k.includes("-")){const _=k.split("-");if(_.length>=3)return`${_[1]}/${_[2]}`}return d.date}),datasets:[{label:"ËæìÂÖ•Token",data:s,borderColor:V.currentColorScheme.primary,backgroundColor:`${V.currentColorScheme.primary}1a`,tension:.3},{label:"ËæìÂá∫Token",data:T,borderColor:V.currentColorScheme.accent,backgroundColor:`${V.currentColorScheme.accent}1a`,tension:.3},{label:"ÁºìÂ≠òÂàõÂª∫Token",data:x,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3},{label:"ÁºìÂ≠òËØªÂèñToken",data:B,borderColor:V.currentColorScheme.secondary,backgroundColor:`${V.currentColorScheme.secondary}1a`,tension:.3},{label:"Ë¥πÁî® (USD)",data:G,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.3,yAxisID:"y2"},{label:"ËØ∑Ê±ÇÊï∞",data:tt,borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.3,yAxisID:"y1"}]};if(Y){Y.data=R;const d=Y.options;d.plugins.title.color=u.value.text,d.plugins.legend.labels.color=u.value.legend,d.scales.x.title.color=u.value.text,d.scales.x.ticks.color=u.value.text,d.scales.x.grid.color=u.value.grid,d.scales.y.title.color=u.value.text,d.scales.y.ticks.color=u.value.text,d.scales.y.grid.color=u.value.grid,d.scales.y1.title.color=u.value.text,d.scales.y1.ticks.color=u.value.text,Y.update("none");return}Y=new Ft(Dt.value,{type:"line",data:R,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{title:{display:!0,text:"Token‰ΩøÁî®Ë∂ãÂäø",font:{size:16,weight:"bold"},color:u.value.text},legend:{position:"top",labels:{color:u.value.legend}},tooltip:{mode:"index",intersect:!1,itemSort:function(d,k){const _=d.dataset.label||"",$=k.dataset.label||"";return _==="Ë¥πÁî® (USD)"||$==="Ë¥πÁî® (USD)"?_==="Ë¥πÁî® (USD)"?-1:1:_==="ËØ∑Ê±ÇÊï∞"||$==="ËØ∑Ê±ÇÊï∞"?_==="ËØ∑Ê±ÇÊï∞"?1:-1:k.parsed.y-d.parsed.y},callbacks:{label:function(d){const k=d.dataset.label||"";let _=d.parsed.y;return k==="Ë¥πÁî® (USD)"?_<.01?k+": $"+_.toFixed(6):k+": $"+_.toFixed(4):k==="ËØ∑Ê±ÇÊï∞"?k+": "+_.toLocaleString()+" Ê¨°":_>=1e6?k+": "+(_/1e6).toFixed(2)+"M tokens":_>=1e3?k+": "+(_/1e3).toFixed(2)+"K tokens":k+": "+_.toLocaleString()+" tokens"}}}},scales:{x:{type:"category",display:!0,title:{display:!0,text:Q==="hour"?"Êó∂Èó¥":"Êó•Êúü",color:u.value.text},ticks:{color:u.value.text},grid:{color:u.value.grid}},y:{type:"linear",display:!0,position:"left",min:0,title:{display:!0,text:"TokenÊï∞Èáè",color:u.value.text},ticks:{callback:function(d){return O(d)},color:u.value.text},grid:{color:u.value.grid}},y1:{type:"linear",display:!0,position:"right",min:0,title:{display:!0,text:"ËØ∑Ê±ÇÊï∞",color:u.value.text},grid:{drawOnChartArea:!1},ticks:{callback:function(d){return d.toLocaleString()},color:u.value.text}},y2:{type:"linear",display:!1,position:"right",min:0}}}})}function ut(){var G,q;if(!xt.value)return;const g=E.value.data||[],s=j.value,T=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#84CC16"],x=((G=E.value.topApiKeys)==null?void 0:G.map((b,R)=>{var k,_;const y=E.value.data.map($=>!$.apiKeys||!$.apiKeys[b]?0:s==="tokens"?$.apiKeys[b].tokens:$.apiKeys[b].requests||0);return{label:((_=(k=E.value.data.find($=>$.apiKeys&&$.apiKeys[b]))==null?void 0:k.apiKeys[b])==null?void 0:_.name)||`API Key ${b}`,data:y,borderColor:T[R%T.length],backgroundColor:T[R%T.length]+"20",tension:.4,fill:!1}}))||[],B=(q=g[0])!=null&&q.date?"date":"hour",tt={labels:g.map(b=>{if(b.label)return b.label;if(B==="hour"){const y=new Date(b.hour),d=String(y.getMonth()+1).padStart(2,"0"),k=String(y.getDate()).padStart(2,"0"),_=String(y.getHours()).padStart(2,"0");return`${d}/${k} ${_}:00`}const R=b.date;if(R&&R.includes("-")){const y=R.split("-");if(y.length>=3)return`${y[1]}/${y[2]}`}return b.date}),datasets:x};if(z){z.data=tt;const b=z.options;b.plugins.legend.labels.color=u.value.legend,b.scales.x.title.color=u.value.text,b.scales.x.ticks.color=u.value.text,b.scales.x.grid.color=u.value.grid,b.scales.y.title.color=u.value.text,b.scales.y.title.text=s==="tokens"?"Token Êï∞Èáè":"ËØ∑Ê±ÇÊ¨°Êï∞",b.scales.y.ticks.color=u.value.text,b.scales.y.grid.color=u.value.grid,z.update("none");return}z=new Ft(xt.value,{type:"line",data:tt,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,font:{size:12},color:u.value.legend}},tooltip:{mode:"index",intersect:!1,itemSort:function(b,R){return R.parsed.y-b.parsed.y},callbacks:{label:function(b){var L;const R=b.dataset.label||"",y=b.parsed.y,d=b.dataIndex,k=E.value.data[d],$=b.chart.data.datasets.map((M,_t)=>({value:M.data[d]||0,index:_t})).sort((M,_t)=>_t.value-M.value).findIndex(M=>M.index===b.datasetIndex)+1;let N="";if($===1?N="ü•á ":$===2?N="ü•à ":$===3&&(N="ü•â "),j.value==="tokens"){let M="";y>=1e6?M=(y/1e6).toFixed(2)+"M":y>=1e3?M=(y/1e3).toFixed(2)+"K":M=y.toLocaleString();const _t=E.value.topApiKeys[b.datasetIndex],mt=(L=k==null?void 0:k.apiKeys)==null?void 0:L[_t],kt=(mt==null?void 0:mt.formattedCost)||"$0.00";return`${N}${R}: ${M} tokens (${kt})`}else return`${N}${R}: ${y.toLocaleString()} Ê¨°`}}}},scales:{x:{type:"category",display:!0,title:{display:!0,text:Q==="hour"?"Êó∂Èó¥":"Êó•Êúü",color:u.value.text},ticks:{color:u.value.text},grid:{color:u.value.grid}},y:{beginAtZero:!0,min:0,title:{display:!0,text:j.value==="tokens"?"Token Êï∞Èáè":"ËØ∑Ê±ÇÊ¨°Êï∞",color:u.value.text},ticks:{callback:function(b){return O(b)},color:u.value.text},grid:{color:u.value.grid}}}}})}async function Ut(){await n(j.value),await nt(),ut()}function Tt(){var q,b,R;if(!ft.value)return;const g=((q=F.value)==null?void 0:q.data)||[],s=((b=F.value)==null?void 0:b.topAccounts)||[],T=["#2563EB","#059669","#D97706","#DC2626","#7C3AED","#F472B6","#0EA5E9","#F97316","#6366F1","#22C55E"],x=s.map((y,d)=>{var $,N;const k=g.map(L=>!L.accounts||!L.accounts[y]?0:L.accounts[y].cost||0);return{label:((N=($=g.find(L=>L.accounts&&L.accounts[y]))==null?void 0:$.accounts[y])==null?void 0:N.name)||`Ë¥¶Âè∑ ${String(y).slice(0,6)}`,data:k,borderColor:T[d%T.length],backgroundColor:T[d%T.length]+"20",tension:.4,fill:!1}}),B=(R=g[0])!=null&&R.date?"date":"hour",tt={labels:g.map(y=>{if(y.label)return y.label;if(B==="hour"){const d=new Date(y.hour),k=String(d.getMonth()+1).padStart(2,"0"),_=String(d.getDate()).padStart(2,"0"),$=String(d.getHours()).padStart(2,"0");return`${k}/${_} ${$}:00`}if(y.date&&y.date.includes("-")){const d=y.date.split("-");if(d.length>=3)return`${d[1]}/${d[2]}`}return y.date}),datasets:x},G=s;if(at){at.data=tt;const y=at.options;y.plugins.legend.labels.color=u.value.legend,y.scales.x.title.color=u.value.text,y.scales.x.title.text=Q.value==="hour"?"Êó∂Èó¥":"Êó•Êúü",y.scales.x.ticks.color=u.value.text,y.scales.x.grid.color=u.value.grid,y.scales.y.title.color=u.value.text,y.scales.y.ticks.color=u.value.text,y.scales.y.grid.color=u.value.grid,at.update("none");return}at=new Ft(ft.value,{type:"line",data:tt,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,font:{size:12},color:u.value.legend}},tooltip:{mode:"index",intersect:!1,itemSort:(y,d)=>d.parsed.y-y.parsed.y,callbacks:{label:function(y){var Vt;const d=y.dataset.label||"",k=y.parsed.y||0,_=y.dataIndex,$=y.datasetIndex,N=G[$],L=F.value.data[_],M=(Vt=L==null?void 0:L.accounts)==null?void 0:Vt[N],mt=y.chart.data.datasets.map((St,Gt)=>({value:St.data[_]||0,index:Gt})).sort((St,Gt)=>Gt.value-St.value).findIndex(St=>St.index===$)+1;let kt="";mt===1?kt="ü•á ":mt===2?kt="ü•à ":mt===3&&(kt="ü•â ");const Qt=(M==null?void 0:M.formattedCost)||ht(k),Jt=(M==null?void 0:M.requests)||0;return`${kt}${d}: ${Qt} / ${Jt.toLocaleString()} Ê¨°`}}}},scales:{x:{type:"category",display:!0,title:{display:!0,text:Q.value==="hour"?"Êó∂Èó¥":"Êó•Êúü",color:u.value.text},ticks:{color:u.value.text},grid:{color:u.value.grid}},y:{beginAtZero:!0,min:0,title:{display:!0,text:"Ê∂àËÄóÈáëÈ¢ù (USD)",color:u.value.text},ticks:{callback:y=>ht(Number(y)),color:u.value.text},grid:{color:u.value.grid}}}}})}async function Zt(g){if(!(wt.value===g||st.value)){st.value=!0;try{await H(g),await nt(),Tt()}finally{st.value=!1}}}pt(Z,()=>{nt(()=>vt())}),pt(lt,()=>{nt(()=>bt())}),pt(E,()=>{nt(()=>ut())}),pt(F,()=>{nt(()=>Tt())});async function Bt(){if(!U.value){U.value=!0;try{await Promise.all([qt(),Et(),f()])}finally{U.value=!1}}}function Ht(){m.value&&(D.value=C.value,P.value&&clearInterval(P.value),w.value&&clearTimeout(w.value),P.value=setInterval(()=>{D.value--,D.value<=0&&clearInterval(P.value)},1e3),w.value=setTimeout(async()=>{await Bt(),m.value&&Ht()},C.value*1e3))}function Nt(){P.value&&(clearInterval(P.value),P.value=null),w.value&&(clearTimeout(w.value),w.value=null),D.value=0}return pt(m,g=>{g?Ht():Nt()}),pt(rt,()=>{nt(()=>{vt(),bt(),ut(),Tt()})}),pt(()=>V.colorScheme,()=>{nt(()=>{vt(),bt(),ut(),Tt()})}),ae(async()=>{await Bt(),await nt(),vt(),bt(),ut(),Tt()}),se(()=>{Nt(),X&&X.destroy(),Y&&Y.destroy(),z&&z.destroy(),at&&at.destroy()}),(g,s)=>{const T=Xt;return v(),h("div",null,[t("div",pe,[t("div",ge,[t("div",ye,[t("div",null,[t("p",xe,a(e(l)("stats.total_api_keys")),1),t("p",fe,a(e(o).totalApiKeys),1),t("p",he,a(e(l)("stats.active"))+": "+a(e(o).activeApiKeys||0),1)]),s[7]||(s[7]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-blue-500 to-blue-600"},[t("i",{class:"fas fa-key"})],-1))])]),t("div",ve,[t("div",be,[t("div",_e,[t("p",ke,a(e(l)("stats.service_accounts")),1),t("div",Ce,[t("p",we,a(e(o).totalAccounts),1),e(o).accountsByPlatform?(v(),h("div",De,[e(o).accountsByPlatform.claude&&e(o).accountsByPlatform.claude.total>0?(v(),h("div",{key:0,class:"inline-flex items-center gap-0.5",title:`Claude: ${e(o).accountsByPlatform.claude.total} ${e(l)("stats.items")} (${e(l)("stats.normal_label")}: ${e(o).accountsByPlatform.claude.normal})`},[s[8]||(s[8]=t("i",{class:"fas fa-brain text-xs text-indigo-600"},null,-1)),t("span",Se,a(e(o).accountsByPlatform.claude.total),1)],8,Te)):A("",!0),e(o).accountsByPlatform["claude-console"]&&e(o).accountsByPlatform["claude-console"].total>0?(v(),h("div",{key:1,class:"inline-flex items-center gap-0.5",title:`Console: ${e(o).accountsByPlatform["claude-console"].total} ‰∏™ (Ê≠£Â∏∏: ${e(o).accountsByPlatform["claude-console"].normal})`},[s[9]||(s[9]=t("i",{class:"fas fa-terminal text-xs text-purple-600"},null,-1)),t("span",Ae,a(e(o).accountsByPlatform["claude-console"].total),1)],8,$e)):A("",!0),e(o).accountsByPlatform.gemini&&e(o).accountsByPlatform.gemini.total>0?(v(),h("div",{key:2,class:"inline-flex items-center gap-0.5",title:`Gemini: ${e(o).accountsByPlatform.gemini.total} ‰∏™ (Ê≠£Â∏∏: ${e(o).accountsByPlatform.gemini.normal})`},[s[10]||(s[10]=t("i",{class:"fas fa-robot text-xs text-yellow-600"},null,-1)),t("span",Ie,a(e(o).accountsByPlatform.gemini.total),1)],8,Re)):A("",!0),e(o).accountsByPlatform.bedrock&&e(o).accountsByPlatform.bedrock.total>0?(v(),h("div",{key:3,class:"inline-flex items-center gap-0.5",title:`Bedrock: ${e(o).accountsByPlatform.bedrock.total} ‰∏™ (Ê≠£Â∏∏: ${e(o).accountsByPlatform.bedrock.normal})`},[s[11]||(s[11]=t("i",{class:"fab fa-aws text-xs text-orange-600"},null,-1)),t("span",Ue,a(e(o).accountsByPlatform.bedrock.total),1)],8,Pe)):A("",!0),e(o).accountsByPlatform.openai&&e(o).accountsByPlatform.openai.total>0?(v(),h("div",{key:4,class:"inline-flex items-center gap-0.5",title:`OpenAI: ${e(o).accountsByPlatform.openai.total} ‰∏™ (Ê≠£Â∏∏: ${e(o).accountsByPlatform.openai.normal})`},[s[12]||(s[12]=t("i",{class:"fas fa-openai text-xs text-gray-100"},null,-1)),t("span",Me,a(e(o).accountsByPlatform.openai.total),1)],8,Be)):A("",!0),e(o).accountsByPlatform.azure_openai&&e(o).accountsByPlatform.azure_openai.total>0?(v(),h("div",{key:5,class:"inline-flex items-center gap-0.5",title:`Azure OpenAI: ${e(o).accountsByPlatform.azure_openai.total} ‰∏™ (Ê≠£Â∏∏: ${e(o).accountsByPlatform.azure_openai.normal})`},[s[13]||(s[13]=t("i",{class:"fab fa-microsoft text-xs text-blue-600"},null,-1)),t("span",Fe,a(e(o).accountsByPlatform.azure_openai.total),1)],8,Oe)):A("",!0),e(o).accountsByPlatform["openai-responses"]&&e(o).accountsByPlatform["openai-responses"].total>0?(v(),h("div",{key:6,class:"inline-flex items-center gap-0.5",title:`OpenAI Responses: ${e(o).accountsByPlatform["openai-responses"].total} ‰∏™ (Ê≠£Â∏∏: ${e(o).accountsByPlatform["openai-responses"].normal})`},[s[14]||(s[14]=t("i",{class:"fas fa-server text-xs text-cyan-600"},null,-1)),t("span",Le,a(e(o).accountsByPlatform["openai-responses"].total),1)],8,Ke)):A("",!0)])):A("",!0)]),t("p",qe,[I(" Ê≠£Â∏∏: "+a(e(o).normalAccounts||0)+" ",1),e(o).abnormalAccounts>0?(v(),h("span",Ee," | ÂºÇÂ∏∏: "+a(e(o).abnormalAccounts),1)):A("",!0),e(o).pausedAccounts>0?(v(),h("span",ze," | ÂÅúÊ≠¢Ë∞ÉÂ∫¶: "+a(e(o).pausedAccounts),1)):A("",!0),e(o).rateLimitedAccounts>0?(v(),h("span",Ge," | ÈôêÊµÅ: "+a(e(o).rateLimitedAccounts),1)):A("",!0)])]),s[15]||(s[15]=t("div",{class:"stat-icon ml-2 flex-shrink-0 bg-gradient-to-br from-green-500 to-green-600"},[t("i",{class:"fas fa-user-circle"})],-1))])]),t("div",je,[t("div",He,[t("div",null,[t("p",Ne,a(e(l)("stats.total_requests")),1),t("p",Ve,a(e(o).todayRequests),1),t("p",Ye,a(e(l)("stats.total_requests_count"))+": "+a(e(O)(e(o).totalRequests||0)),1)]),s[16]||(s[16]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-purple-500 to-purple-600"},[t("i",{class:"fas fa-chart-line"})],-1))])]),t("div",We,[t("div",Ze,[t("div",null,[t("p",Qe,a(e(l)("stats.system_status")),1),t("p",Je,a(e(o).systemStatus),1),t("p",Xe,a(e(l)("stats.uptime"))+": "+a(e(At)),1),t("p",ta,a(e(l)("stats.success_rate"))+": "+a(g.successRate)+"% ",1)]),s[17]||(s[17]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-yellow-500 to-orange-500"},[t("i",{class:"fas fa-heartbeat"})],-1))])])]),t("div",ea,[t("div",aa,[t("div",sa,[t("div",null,[s[18]||(s[18]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," Ë¥¶Êà∑‰ΩôÈ¢ù/ÈÖçÈ¢ù ",-1)),t("p",oa,a(r(dt.value.totalBalance||0)),1),t("p",na," ‰Ωé‰ΩôÈ¢ù: "+a(dt.value.lowBalanceCount||0)+" | ÊÄªÊàêÊú¨: "+a(r(dt.value.totalCost||0)),1)]),s[19]||(s[19]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-emerald-500 to-green-600"},[t("i",{class:"fas fa-wallet"})],-1))]),t("div",ra,[t("p",la," Êõ¥Êñ∞Êó∂Èó¥: "+a(i(It.value)),1),t("button",{class:"flex items-center gap-2 rounded-lg border border-gray-200 bg-white px-3 py-1.5 text-xs font-medium text-gray-700 shadow-sm transition-all duration-200 hover:border-gray-300 hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:border-gray-500",disabled:ot.value,onClick:f},[t("i",{class:W(["fas",ot.value?"fa-spinner fa-spin":"fa-sync-alt"])},null,2),s[20]||(s[20]=I(" Âà∑Êñ∞ ",-1))],8,ia)])]),t("div",ca,[t("div",da,[s[21]||(s[21]=t("h3",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},"‰Ωé‰ΩôÈ¢ùË¥¶Êà∑",-1)),t("span",ua,a(p.value.length)+" ‰∏™ ",1)]),ot.value?(v(),h("div",ma," Ê≠£Âú®Âä†ËΩΩ... ")):p.value.length===0?(v(),h("div",pa," ÂÖ®ÈÉ®Ê≠£Â∏∏ ")):(v(),h("div",ga,[(v(!0),h(Mt,null,Ot(p.value,x=>{var B;return v(),h("div",{key:x.accountId,class:"rounded-lg border border-red-200 bg-red-50 p-3 dark:border-red-900/60 dark:bg-red-900/20"},[t("div",ya,[t("div",xa,a(x.name||x.accountId),1),t("span",fa,a(c(x.platform)),1)]),t("div",ha,[x.balance?(v(),h("span",va,"‰ΩôÈ¢ù: "+a(x.balance.formattedAmount),1)):(v(),h("span",ba,"‰ªäÊó•ÊàêÊú¨: "+a(r(((B=x.statistics)==null?void 0:B.dailyCost)||0)),1))]),x.quota&&typeof x.quota.percentage=="number"?(v(),h("div",_a,[t("div",ka,[s[22]||(s[22]=t("span",null,"ÈÖçÈ¢ù‰ΩøÁî®",-1)),t("span",Ca,a(x.quota.percentage.toFixed(1))+"% ",1)]),t("div",wa,[t("div",{class:"h-2 rounded-full bg-red-500",style:le({width:`${Math.min(100,x.quota.percentage)}%`})},null,4)])])):A("",!0)])}),128))]))])]),t("div",Da,[t("div",Ta,[t("div",Sa,[t("div",$a,[t("p",Aa,a(e(l)("stats.today_tokens")),1),t("div",Ra,[t("p",Ia,a(e(O)((e(o).todayInputTokens||0)+(e(o).todayOutputTokens||0)+(e(o).todayCacheCreateTokens||0)+(e(o).todayCacheReadTokens||0))),1),t("span",Pa,"/ "+a(e(Ct).todayCosts.formatted.totalCost),1)]),t("div",Ua,[t("div",Ba,[t("span",null,[I(a(e(l)("stats.input"))+": ",1),t("span",Ma,a(e(O)(e(o).todayInputTokens||0)),1)]),t("span",null,[I(a(e(l)("stats.output"))+": ",1),t("span",Oa,a(e(O)(e(o).todayOutputTokens||0)),1)]),(e(o).todayCacheCreateTokens||0)>0?(v(),h("span",Fa,[I(a(e(l)("stats.cache_create"))+": ",1),t("span",Ka,a(e(O)(e(o).todayCacheCreateTokens||0)),1)])):A("",!0),(e(o).todayCacheReadTokens||0)>0?(v(),h("span",La,[I(a(e(l)("stats.cache_read"))+": ",1),t("span",qa,a(e(O)(e(o).todayCacheReadTokens||0)),1)])):A("",!0)])])]),s[23]||(s[23]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-indigo-500 to-indigo-600"},[t("i",{class:"fas fa-coins"})],-1))])]),t("div",Ea,[t("div",za,[t("div",Ga,[t("p",ja,a(e(l)("stats.total_token_consumption")),1),t("div",Ha,[t("p",Na,a(e(O)((e(o).totalInputTokens||0)+(e(o).totalOutputTokens||0)+(e(o).totalCacheCreateTokens||0)+(e(o).totalCacheReadTokens||0))),1),t("span",Va,"/ "+a(e(Ct).totalCosts.formatted.totalCost),1)]),t("div",Ya,[t("div",Wa,[t("span",null,[I(a(e(l)("stats.input"))+": ",1),t("span",Za,a(e(O)(e(o).totalInputTokens||0)),1)]),t("span",null,[I(a(e(l)("stats.output"))+": ",1),t("span",Qa,a(e(O)(e(o).totalOutputTokens||0)),1)]),(e(o).totalCacheCreateTokens||0)>0?(v(),h("span",Ja,[I(a(e(l)("stats.cache_create"))+": ",1),t("span",Xa,a(e(O)(e(o).totalCacheCreateTokens||0)),1)])):A("",!0),(e(o).totalCacheReadTokens||0)>0?(v(),h("span",ts,[I(a(e(l)("stats.cache_read"))+": ",1),t("span",es,a(e(O)(e(o).totalCacheReadTokens||0)),1)])):A("",!0)])])]),s[24]||(s[24]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-emerald-500 to-emerald-600"},[t("i",{class:"fas fa-database"})],-1))])]),t("div",as,[t("div",ss,[t("div",null,[t("p",os,[I(a(e(l)("stats.realtime_rpm"))+" ",1),t("span",ns,"("+a(e(o).metricsWindow)+"ÂàÜÈíü)",1)]),t("p",rs,a(e(o).realtimeRPM||0),1),t("p",ls,[I(a(e(l)("stats.requests_per_minute"))+" ",1),e(o).isHistoricalMetrics?(v(),h("span",is,[s[25]||(s[25]=t("i",{class:"fas fa-exclamation-circle"},null,-1)),I(" "+a(e(l)("stats.historical_data")),1)])):A("",!0)])]),s[26]||(s[26]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-orange-500 to-orange-600"},[t("i",{class:"fas fa-tachometer-alt"})],-1))])]),t("div",cs,[t("div",ds,[t("div",null,[t("p",us,[I(a(e(l)("stats.realtime_tpm"))+" ",1),t("span",ms,"("+a(e(o).metricsWindow)+"ÂàÜÈíü)",1)]),t("p",ps,a(e(O)(e(o).realtimeTPM||0)),1),t("p",gs,[I(a(e(l)("stats.tokens_per_minute"))+" ",1),e(o).isHistoricalMetrics?(v(),h("span",ys,[s[27]||(s[27]=t("i",{class:"fas fa-exclamation-circle"},null,-1)),I(" "+a(e(l)("stats.historical_data")),1)])):A("",!0)])]),s[28]||(s[28]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-rose-500 to-rose-600"},[t("i",{class:"fas fa-rocket"})],-1))])])]),t("div",xs,[t("div",fs,[t("h3",hs,a(e(l)("stats.model_usage_and_token_trend")),1),t("div",vs,[t("div",bs,[(v(!0),h(Mt,null,Ot(e(et).presetOptions,x=>(v(),h("button",{key:x.value,class:W(["rounded-md px-3 py-1 text-sm font-medium transition-colors",e(et).preset===x.value&&e(et).type==="preset"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:B=>e(K)(x.value)},a(x.label),11,_s))),128))]),t("div",ks,[t("button",{class:W(["rounded-md px-3 py-1 text-sm font-medium transition-colors",e(Q)==="day"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:s[0]||(s[0]=x=>e(it)("day"))},[s[29]||(s[29]=t("i",{class:"fas fa-calendar-day mr-1"},null,-1)),I(a(e(l)("trend.by_day")),1)],2),t("button",{class:W(["rounded-md px-3 py-1 text-sm font-medium transition-colors",e(Q)==="hour"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:s[1]||(s[1]=x=>e(it)("hour"))},[s[30]||(s[30]=t("i",{class:"fas fa-clock mr-1"},null,-1)),I(a(e(l)("trend.by_hour")),1)],2)]),t("div",Cs,[oe(T,{modelValue:e(et).customRange,"onUpdate:modelValue":s[2]||(s[2]=x=>e(et).customRange=x),class:"custom-date-picker w-full lg:w-auto","default-time":yt,"disabled-date":e(ct),"end-placeholder":e(l)("date.end_placeholder"),format:"YYYY-MM-DD HH:mm:ss","range-separator":e(l)("date.separator"),size:"default","start-placeholder":e(l)("date.start_placeholder"),style:{"max-width":"400px"},type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss",onChange:e(Rt)},null,8,["modelValue","disabled-date","end-placeholder","range-separator","start-placeholder","onChange"]),e(Q)==="hour"?(v(),h("span",ws,[s[31]||(s[31]=t("i",{class:"fas fa-info-circle"},null,-1)),I(" "+a(e(l)("trend.max_24h")),1)])):A("",!0)]),t("div",Ds,[t("div",Ts,[t("label",Ss,[ne(t("input",{"onUpdate:modelValue":s[3]||(s[3]=x=>m.value=x),class:"peer sr-only",type:"checkbox"},null,512),[[re,m.value]]),s[33]||(s[33]=t("div",{class:"peer relative h-5 w-9 rounded-full bg-gray-300 transition-all duration-200 after:absolute after:left-[2px] after:top-0.5 after:h-4 after:w-4 after:rounded-full after:bg-white after:shadow-sm after:transition-transform after:duration-200 after:content-[''] peer-checked:bg-blue-500 peer-checked:after:translate-x-4 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:bg-gray-600 dark:after:bg-gray-300 dark:peer-focus:ring-blue-600"},null,-1)),t("span",$s,[s[32]||(s[32]=t("i",{class:"fas fa-redo-alt text-xs text-gray-500 dark:text-gray-400"},null,-1)),t("span",null,a(e(l)("refresh.auto_refresh")),1),m.value?(v(),h("span",{key:0,class:W(["ml-1 font-mono text-xs text-blue-600 transition-opacity",D.value>0?"opacity-100":"opacity-0"])},a(D.value)+"s ",3)):A("",!0)])])]),t("button",{class:"flex items-center gap-1 rounded-md border border-gray-300 bg-white px-3 py-1 text-sm font-medium text-blue-600 shadow-sm transition-colors hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 sm:gap-2",disabled:U.value,title:e(l)("refresh.refresh_now"),onClick:s[4]||(s[4]=x=>Bt())},[t("i",{class:W(["fas fa-sync-alt text-xs",{"animate-spin":U.value}])},null,2),t("span",Rs,a(U.value?e(l)("refresh.refreshing"):e(l)("refresh.refresh")),1)],8,As)])])]),t("div",Is,[t("div",Ps,[t("h4",Us,a(e(l)("stats.token_usage_distribution")),1),t("div",Bs,[t("canvas",{ref_key:"modelUsageChart",ref:J},null,512)])]),t("div",Ms,[t("h4",Os,a(e(l)("stats.detailed_statistics")),1),e(Z).length===0?(v(),h("div",Fs,[t("p",Ks,a(e(l)("stats.no_model_usage_data")),1)])):(v(),h("div",Ls,[t("table",qs,[t("thead",Es,[t("tr",null,[t("th",zs,a(e(l)("stats.model")),1),t("th",Gs,a(e(l)("stats.requests")),1),t("th",js,a(e(l)("stats.total_tokens")),1),t("th",Hs,a(e(l)("stats.cost")),1),t("th",Ns,a(e(l)("stats.proportion")),1)])]),t("tbody",Vs,[(v(!0),h(Mt,null,Ot(e(Z),x=>(v(),h("tr",{key:x.model,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",Ys,[t("span",{class:"block max-w-[100px] truncate sm:max-w-none",title:x.model},a(x.model),9,Ws)]),t("td",Zs,a(e(O)(x.requests)),1),t("td",Qs,a(e(O)(x.allTokens)),1),t("td",Js,a(x.formatted?x.formatted.total:"$0.000000"),1),t("td",Xs,[t("span",to,a(Pt(x.allTokens,e(Z)))+"% ",1)])]))),128))])])]))])])]),t("div",eo,[t("div",ao,[t("div",so,[t("h2",oo,a(e(l)("stats.token_usage_trend")),1),t("button",{class:W(["flex items-center gap-1.5 rounded-md px-2 py-1 text-xs transition-colors hover:bg-gray-100 dark:hover:bg-gray-700 sm:px-3 sm:py-1.5 sm:text-sm",{"opacity-70":U.value}]),disabled:U.value,onClick:Bt},[t("i",{class:W(["fas fa-sync-alt",{"animate-spin":U.value}])},null,2),I(" "+a(U.value?e(l)("refresh.refreshing"):e(l)("refresh.refresh")),1)],10,no)]),t("div",ro,[t("canvas",{ref_key:"usageTrendChart",ref:Dt},null,512)])])]),t("div",lo,[t("div",io,[t("div",co,[t("h3",uo,a(e(l)("stats.api_keys_usage_trend")),1),t("div",mo,[t("button",{class:W(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",e(j)==="requests"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:s[5]||(s[5]=x=>(j.value="requests",Ut()))},[s[34]||(s[34]=t("i",{class:"fas fa-exchange-alt mr-1"},null,-1)),t("span",po,a(e(l)("stats.requests_count")),1),t("span",go,a(e(l)("stats.requests")),1)],2),t("button",{class:W(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",e(j)==="tokens"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:s[6]||(s[6]=x=>(j.value="tokens",Ut()))},[s[35]||(s[35]=t("i",{class:"fas fa-coins mr-1"},null,-1)),t("span",yo,a(e(l)("stats.token_quantity")),1),t("span",xo,a(e(l)("stats.tokens")),1)],2)])]),t("div",fo,[e(E).totalApiKeys>10?(v(),h("span",ho,a(e(l)("stats.total"))+" "+a(e(E).totalApiKeys)+" "+a(e(l)("stats.api_key_items"))+"Ôºå"+a(e(l)("stats.display_top_10")),1)):(v(),h("span",vo,a(e(l)("stats.total"))+" "+a(e(E).totalApiKeys)+" "+a(e(l)("stats.api_key_items")),1))]),t("div",bo,[t("canvas",{ref_key:"apiKeysUsageTrendChart",ref:xt},null,512)])])]),t("div",_o,[t("div",ko,[t("div",Co,[t("div",wo,[t("h3",Do,a(e(l)("stats.account_usage_trend")),1),t("span",To,a(e(l)("stats.current_group"))+"Ôºö"+a(e(F).groupLabel||e(l)("stats.not_selected")),1)]),t("div",So,[t("div",$o,[(v(),h(Mt,null,Ot(zt,x=>t("button",{key:x.value,class:W(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",e(wt)===x.value?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:B=>Zt(x.value)},a(x.label),11,Ao)),64))])])]),t("div",Ro,[t("span",null,a(e(l)("stats.total"))+" "+a(e(F).totalAccounts||0)+" "+a(e(l)("stats.account_items")),1),e(F).topAccounts&&e(F).topAccounts.length?(v(),h("span",Io,a(e(l)("stats.display_top_n_accounts",{n:e(F).topAccounts.length})),1)):A("",!0)]),!e(F).data||e(F).data.length===0?(v(),h("div",Po,a(e(l)("stats.no_account_usage_data")),1)):(v(),h("div",Uo,[t("canvas",{ref_key:"accountUsageTrendChart",ref:ft},null,512)]))])])])}}},qo=ce(Bo,[["__scopeId","data-v-618c538e"]]);export{qo as default};
