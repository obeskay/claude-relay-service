import{aP as Oe,r as T,c as M,a_ as ce,x as l,y as a,z as e,O as k,L as b,P as n,u as t,C as L,K as xe,aY as Fe,aa as $e,f as Ie,aq as Se,Y as Ce,Q as Z,ac as se,B as be,R as ee,q as Ee,o as Te,V as De,I as ve,aW as je,a5 as qe,aZ as We,J as _e,T as ze,av as Ve,al as Be}from"./vue-vendor-DMOLwvvm.js";import{bf as Le,bg as Pe,bh as ke,b1 as He,bi as Ge,bj as Je,bk as Qe,_ as me,f as O,Z as Ue,c as Ye,aH as Ze,aO as Xe,a as et,bl as tt,s as Re,bm as st,bn as at}from"./index-UbVhXwtH.js";import{L as rt}from"./LogoTitle-HCWhCZ0l.js";import{T as lt}from"./ThemeToggle-DaWPUuX9.js";import"./vendor-CSA95d8J.js";import{_ as ot}from"./WindowCountdown-HMGOflUu.js";import{T as nt}from"./TutorialView-BUnSRk1D.js";import"./element-plus-BS6u3EDt.js";const ge=Oe("apistats",()=>{const U=T(""),K=T(null),i=T(!1),_=T(!1),g=T(!0),v=T(""),h=T("daily"),$=T(null),I=T([]),P=T([]),w=T([]),u=T([]),x=T(null),f=T(null),c=T(null),o=T({siteName:"",siteIcon:"",siteIconData:""}),C=T(!1),j=T([]),E=T([]),q=T(null),F=T([]),Q=T([]),W=T(null),H=T({}),te=M(()=>{const y={requests:0,inputTokens:0,outputTokens:0,cacheCreateTokens:0,cacheReadTokens:0,allTokens:0,cost:0,formattedCost:"$0.000000"};return C.value&&q.value?h.value==="daily"?q.value.dailyUsage||y:h.value==="monthly"?q.value.monthlyUsage||y:q.value.alltimeUsage||y:h.value==="daily"?x.value||y:h.value==="monthly"?f.value||y:c.value||y}),oe=M(()=>{if(!$.value||!te.value)return{tokenUsage:0,costUsage:0,requestUsage:0};const y=te.value,S=$.value.limits;return{tokenUsage:S.tokenLimit>0?Math.min(y.allTokens/S.tokenLimit*100,100):0,costUsage:S.dailyCostLimit>0?Math.min(y.cost/S.dailyCostLimit*100,100):0,requestUsage:S.rateLimitRequests>0?Math.min(y.requests/S.rateLimitRequests*100,100):0}});async function ne(){if(C.value)return J();const y=U.value.trim();if(!y){v.value="请输入 API Key";return}if(y.length<10||y.length>512){v.value="API Key 格式无效：长度应在 10-512 个字符之间";return}i.value=!0,v.value="",$.value=null,I.value=[],K.value=null;try{const S=await Le(y);if(S.success){K.value=S.data.id;const R=await Pe(K.value);if(R.success)$.value=R.data,H.value=R.data.serviceRates||{},await Y(),v.value="",de(),re();else throw new Error(R.message||"查询失败")}else throw new Error(S.message||"获取 API Key ID 失败")}catch(S){console.error("Query stats error:",S),v.value=S.message||"查询统计数据失败，请检查您的 API Key 是否正确",$.value=null,I.value=[],K.value=null}finally{i.value=!1}}async function Y(){K.value&&(await Promise.all([G("daily"),G("monthly")]),await X())}async function X(){if(K.value){_.value=!0;try{const[y,S,R]=await Promise.all([ke(K.value,"daily"),ke(K.value,"monthly"),ke(K.value,"alltime")]);P.value=y.success?y.data||[]:[],w.value=S.success?S.data||[]:[],u.value=R.success?R.data||[]:[],I.value=P.value}catch(y){console.error("Load all model stats error:",y),P.value=[],w.value=[],u.value=[],I.value=[]}finally{_.value=!1}}}async function G(y){try{const S=await ke(K.value,y);if(S.success){const R=S.data||[],z={requests:0,inputTokens:0,outputTokens:0,cacheCreateTokens:0,cacheReadTokens:0,allTokens:0,cost:0,formattedCost:"$0.000000"};R.forEach(p=>{var d;z.requests+=p.requests||0,z.inputTokens+=p.inputTokens||0,z.outputTokens+=p.outputTokens||0,z.cacheCreateTokens+=p.cacheCreateTokens||0,z.cacheReadTokens+=p.cacheReadTokens||0,z.allTokens+=p.allTokens||0,z.cost+=((d=p.costs)==null?void 0:d.total)||0}),z.formattedCost=B(z.cost),y==="daily"?x.value=z:y==="monthly"?f.value=z:y==="alltime"&&(c.value=z)}else console.warn(`Failed to load ${y} stats:`,S.message)}catch(S){console.error(`Load ${y} stats error:`,S)}}async function r(y="daily"){if(K.value){_.value=!0;try{const S=await ke(K.value,y);if(S.success)I.value=S.data||[];else throw new Error(S.message||"加载模型统计失败")}catch(S){console.error("Load model stats error:",S),I.value=[]}finally{_.value=!1}}}async function s(y){if(!(h.value===y||_.value)){if(h.value=y,C.value&&E.value.length>0){await ae(y);return}(y==="daily"&&!x.value||y==="monthly"&&!f.value||y==="alltime"&&!c.value)&&await G(y),await r(y)}}async function m(){var y,S;if(K.value){i.value=!0,v.value="",$.value=null,I.value=[];try{const R=await Pe(K.value);if(R.success)$.value=R.data,H.value=R.data.serviceRates||{},console.log("API Stats - Full response:",R.data),console.log("API Stats - limits data:",R.data.limits),console.log("API Stats - weeklyOpusCostLimit:",(y=R.data.limits)==null?void 0:y.weeklyOpusCostLimit),console.log("API Stats - weeklyOpusCost:",(S=R.data.limits)==null?void 0:S.weeklyOpusCost),await Y(),v.value="";else throw new Error(R.message||"查询失败")}catch(R){console.error("Load stats with apiId error:",R),v.value=R.message||"查询统计数据失败",$.value=null,I.value=[]}finally{i.value=!1}}}async function A(){g.value=!0;try{const y=await He();y&&y.success&&y.data&&(o.value={...o.value,...y.data})}catch(y){console.error("Error loading OEM settings:",y),o.value={siteName:"Claude Relay Service",siteIcon:"",siteIconData:""}}finally{g.value=!1}}async function N(){try{const y=await Ge();y&&y.success&&y.data&&(W.value=y.data)}catch(y){console.error("Error loading service rates:",y),W.value=null}}function B(y){return typeof y!="number"||y===0?"$0.000000":y>=1?"$"+y.toFixed(2):y>=.01?"$"+y.toFixed(4):"$"+y.toFixed(6)}function de(){if(K.value){const y=new URL(window.location);y.searchParams.set("apiId",K.value),window.history.pushState({},"",y)}}function re(){U.value&&localStorage.setItem("lastApiKey",U.value)}function ie(){return localStorage.getItem("lastApiKey")}async function J(){const y=ue();if(y.length===0){v.value="请输入至少一个有效的 API Key";return}i.value=!0,v.value="",q.value=null,F.value=[],Q.value=[],I.value=[],j.value=y,E.value=[],H.value={};try{const S=await Promise.allSettled(y.map(d=>Le(d))),R=[],z=[];if(S.forEach((d,V)=>{d.status==="fulfilled"&&d.value.success?(R.push(d.value.data.id),z.push(y[V])):Q.value.push(y[V])}),R.length===0)throw new Error("所有 API Key 都无效");E.value=R,j.value=z;const p=await Je(R);if(p.success)q.value=p.data.aggregated,F.value=p.data.individual,$.value=p.data.aggregated,x.value=p.data.aggregated.dailyUsage||null,f.value=p.data.aggregated.monthlyUsage||null,await ae(h.value),ye();else throw new Error(p.message||"批量查询失败")}catch(S){console.error("Batch query error:",S),v.value=S.message||"批量查询统计数据失败",q.value=null,F.value=[]}finally{i.value=!1}}async function ae(y="daily"){if(E.value.length!==0){_.value=!0;try{const S=await Qe(E.value,y);if(S.success)I.value=S.data||[];else throw new Error(S.message||"加载批量模型统计失败")}catch(S){console.error("Load batch model stats error:",S),I.value=[]}finally{_.value=!1}}}function ue(){if(!U.value)return[];const y=U.value.split(/[,\n]+/).map(R=>R.trim()).filter(R=>R.length>=10&&R.length<=512);return[...new Set(y)].slice(0,30)}function ye(){if(E.value.length>0){const y=new URL(window.location);y.searchParams.set("apiIds",E.value.join(",")),y.searchParams.set("batch","true"),window.history.pushState({},"",y)}}function fe(){U.value=""}function pe(){$.value=null,I.value=[],P.value=[],w.value=[],u.value=[],x.value=null,f.value=null,c.value=null,v.value="",h.value="daily",K.value=null,H.value={},j.value=[],E.value=[],q.value=null,F.value=[],Q.value=[]}function he(){U.value="",C.value=!1,pe()}return{apiKey:U,apiId:K,loading:i,modelStatsLoading:_,oemLoading:g,error:v,statsPeriod:h,statsData:$,modelStats:I,dailyModelStats:P,monthlyModelStats:w,alltimeModelStats:u,dailyStats:x,monthlyStats:f,alltimeStats:c,oemSettings:o,multiKeyMode:C,apiKeys:j,apiIds:E,aggregatedStats:q,individualStats:F,invalidKeys:Q,serviceRates:W,keyServiceRates:H,currentPeriodData:te,usagePercentages:oe,queryStats:ne,queryBatchStats:J,loadAllPeriodStats:Y,loadAllModelStats:X,loadPeriodStats:G,loadModelStats:r,loadBatchModelStats:ae,switchPeriod:s,loadStatsWithApiId:m,loadOemSettings:A,loadServiceRates:N,loadApiKeyFromStorage:ie,clearData:pe,clearInput:fe,reset:he}}),it={class:"api-input-wide-card mb-8 rounded-3xl p-6 shadow-xl"},dt={class:"mx-auto max-w-4xl"},ut={class:"control-bar mb-4 flex flex-wrap items-center justify-between gap-3"},ct={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},mt={class:"button-group flex items-center gap-2"},gt={class:"mode-switch-group flex items-center rounded-lg bg-gray-100 p-1 dark:bg-gray-800"},xt={key:0,class:"ml-1 rounded-full bg-white/20 px-1.5 py-0.5 text-xs font-semibold"},yt={class:"api-input-grid grid grid-cols-1 gap-4 lg:grid-cols-4"},ft={class:"lg:col-span-3"},pt={key:0,class:"relative"},vt=["disabled","type"],bt={key:1,class:"relative"},kt=["disabled"],ht={class:"lg:col-span-1"},_t=["disabled"],wt={key:0,class:"fas fa-spinner loading-spinner"},$t={key:1,class:"fas fa-search"},Ct={class:"security-notice mt-4"},Tt={key:0,class:"mt-2 rounded-lg bg-blue-50 p-3 text-sm text-blue-700 dark:bg-blue-900/20 dark:text-blue-400"},St={__name:"ApiKeyInput",setup(U){const K=ge(),{apiKey:i,loading:_,multiKeyMode:g}=ce(K),{queryStats:v,clearInput:h}=K,$=T(!1),I=M(()=>{if(!g.value||!i.value)return[];const w=i.value.split(/[,\n]+/).map(x=>x.trim()).filter(x=>x.length>0);return[...new Set(w)].slice(0,30)}),P=M(()=>g.value?I.value.length>0:i.value&&i.value.trim().length>0);return(w,u)=>(a(),l("div",it,[u[16]||(u[16]=e("div",{class:"wide-card-title mb-6"},[e("h2",{class:"mb-2 text-2xl font-bold text-gray-900 dark:text-gray-200"},[e("i",{class:"fas fa-chart-line mr-3"}),k(" Consulta de Estadísticas de Uso ")]),e("p",{class:"text-base text-gray-600 dark:text-gray-400"},"Consulte el uso y las estadísticas de su API Key")],-1)),e("div",dt,[e("div",ut,[e("label",ct,[u[9]||(u[9]=e("i",{class:"fas fa-key mr-2"},null,-1)),k(" "+n(t(g)?"Ingrese sus API Keys (una por línea o separadas por comas)":"Ingrese su API Key"),1)]),e("div",mt,[e("div",gt,[e("button",{class:L(["mode-switch-btn",{active:!t(g)}]),title:"Modo Individual",onClick:u[0]||(u[0]=x=>g.value=!1)},u[10]||(u[10]=[e("i",{class:"fas fa-key"},null,-1),e("span",{class:"ml-2 hidden sm:inline"},"Individual",-1)]),2),e("button",{class:L(["mode-switch-btn",{active:t(g)}]),title:"Modo Agregado",onClick:u[1]||(u[1]=x=>g.value=!0)},[u[11]||(u[11]=e("i",{class:"fas fa-layer-group"},null,-1)),u[12]||(u[12]=e("span",{class:"ml-2 hidden sm:inline"},"Agregado",-1)),t(g)&&I.value.length>0?(a(),l("span",xt,n(I.value.length),1)):b("",!0)],2)])])]),e("div",yt,[e("div",ft,[t(g)?(a(),l("div",bt,[xe(e("textarea",{"onUpdate:modelValue":u[5]||(u[5]=x=>Ie(i)?i.value=x:null),class:"wide-card-input w-full resize-y",disabled:t(_),placeholder:`Ingrese sus API Keys, formatos compatibles:
cr_xxx
cr_yyy
o
cr_xxx, cr_yyy`,rows:"4",onKeyup:u[6]||(u[6]=$e(Ce((...x)=>t(v)&&t(v)(...x),["ctrl"]),["enter"]))},null,40,kt),[[Se,t(i)]]),t(i)&&!t(_)?(a(),l("button",{key:0,class:"absolute right-2 top-2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",title:"Limpiar entrada",onClick:u[7]||(u[7]=(...x)=>t(h)&&t(h)(...x))},u[13]||(u[13]=[e("i",{class:"fas fa-times-circle"},null,-1)]))):b("",!0)])):(a(),l("div",pt,[xe(e("input",{"onUpdate:modelValue":u[2]||(u[2]=x=>Ie(i)?i.value=x:null),class:"wide-card-input w-full pr-10",disabled:t(_),placeholder:"Ingrese su API Key (cr_...)",type:$.value?"text":"password",onKeyup:u[3]||(u[3]=$e((...x)=>t(v)&&t(v)(...x),["enter"]))},null,40,vt),[[Fe,t(i)]]),e("button",{class:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",type:"button",onClick:u[4]||(u[4]=x=>$.value=!$.value)},[e("i",{class:L($.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])]))]),e("div",ht,[e("button",{class:"btn btn-primary btn-query flex h-full w-full items-center justify-center gap-2",disabled:t(_)||!P.value,onClick:u[8]||(u[8]=(...x)=>t(v)&&t(v)(...x))},[t(_)?(a(),l("i",wt)):(a(),l("i",$t)),k(" "+n(t(_)?"Consultando...":"Consultar Estadísticas"),1)],8,_t)])]),e("div",Ct,[u[14]||(u[14]=e("i",{class:"fas fa-shield-alt mr-2"},null,-1)),k(" "+n(t(g)?"Sus API Keys solo se usan para consultar datos estadísticos, no se almacenan. En modo agregado, cierta información individual no se mostrará.":"Su API Key solo se usa para consultar sus propias estadísticas, no se almacena ni se usa para otros fines"),1)]),t(g)?(a(),l("div",Tt,u[15]||(u[15]=[e("i",{class:"fas fa-lightbulb mr-2"},null,-1),e("span",null,"Sugerencia: Se admite consultar hasta 30 API Keys simultáneamente. Use Ctrl+Enter para consultar rápidamente.",-1)]))):b("",!0)])]))}},At=me(St,[["__scopeId","data-v-d7d791e7"]]),Kt={class:"space-y-4 sm:space-y-6 md:space-y-8"},It={class:"grid grid-cols-1 items-stretch gap-3 sm:gap-4 md:gap-6 xl:grid-cols-[minmax(0,1.5fr)_minmax(0,1fr)]"},jt={class:"card-section"},Lt={class:"section-header"},Pt={class:"header-title"},Rt={key:0,class:"info-grid"},Mt={class:"info-item"},Et={class:"info-value"},Dt={class:"info-item"},qt={class:"info-value text-green-600 dark:text-emerald-400"},Ut={key:0,class:"info-item"},Nt={class:"info-value text-red-500 dark:text-red-400"},Ot={class:"info-item"},Ft={class:"info-value"},Wt={class:"info-item"},zt={class:"info-value"},Vt={class:"info-item"},Bt={class:"info-value text-indigo-600 dark:text-indigo-300"},Ht={key:1,class:"info-item xl:col-span-2"},Gt={class:"space-y-2"},Jt={class:"truncate"},Qt={class:"font-semibold"},Yt={key:1,class:"info-grid"},Zt={class:"info-value flex items-center gap-1 break-all"},Xt={class:"info-item"},es={class:"info-item"},ts={class:"info-value"},ss={key:0,class:"info-item xl:col-span-2"},as={class:"flex flex-wrap gap-2"},rs={class:"info-item"},ls={class:"info-value break-all"},os={class:"info-item xl:col-span-2"},ns={class:"info-value"},is={class:"ml-2 text-xs text-gray-500 dark:text-gray-400"},ds={key:0,class:"text-red-500 dark:text-red-400"},us={key:1,class:"text-orange-500 dark:text-orange-400"},cs={key:2},ms={key:2,class:"text-gray-400 dark:text-gray-500"},gs={class:"card-section"},xs={class:"section-header"},ys={class:"header-tag"},fs={class:"metric-grid"},ps={class:"metric-card"},vs={class:"metric-value text-green-600 dark:text-emerald-300"},bs={class:"metric-label"},ks={class:"metric-card"},hs={class:"metric-value text-blue-600 dark:text-sky-300"},_s={class:"metric-label"},ws={class:"metric-card"},$s={class:"metric-value text-purple-600 dark:text-violet-300"},Cs={class:"metric-label"},Ts={class:"metric-card"},Ss={class:"metric-value text-amber-500 dark:text-amber-300"},As={class:"metric-label"},Ks={key:0,class:"card-section"},Is={class:"flex items-center justify-between gap-3"},js={class:"flex items-center gap-3"},Ls={class:"account-name"},Ps={class:"account-sub"},Rs={key:0,class:"mt-3 space-y-2"},Ms={class:"progress-row"},Es={class:"progress-track"},Ds={class:"progress-value"},qs={class:"flex flex-wrap items-center gap-2 text-xs text-gray-600 dark:text-gray-300"},Us={key:0,class:"font-medium text-indigo-600 dark:text-indigo-400"},Ns={key:1,class:"mt-3"},Os={key:0,class:"space-y-2"},Fs={class:"quota-header"},Ws={class:"quota-percent"},zs={class:"progress-track"},Vs={class:"quota-foot"},Bs={key:1,class:"rounded-xl bg-gray-100 px-3 py-2 text-xs text-gray-500 dark:bg-gray-800 dark:text-gray-300"},Hs={__name:"StatsOverview",setup(U){const K=ge(),{statsData:i,statsPeriod:_,currentPeriodData:g,multiKeyMode:v,aggregatedStats:h,individualStats:$,invalidKeys:I}=ce(K),P=M(()=>!$.value||$.value.length===0?[]:[...$.value].sort((r,s)=>{var m,A;return(((m=s.usage)==null?void 0:m.allTokens)||0)-(((A=r.usage)==null?void 0:A.allTokens)||0)}).slice(0,3)),w=M(()=>{var r;return((r=i.value)==null?void 0:r.serviceRates)&&Object.keys(i.value.serviceRates).length>0}),u=r=>{var m;return!h.value||!h.value.usage.allTokens?0:((((m=r.usage)==null?void 0:m.allTokens)||0)/h.value.usage.allTokens*100).toFixed(1)},x=r=>r?new Date(r).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"",f=r=>r?new Date(r)<new Date:!1,c=r=>{if(!r)return!1;const A=(new Date(r)-new Date)/(1e3*60*60*24);return A>0&&A<=7},o=r=>{const s={claude:"Claude",gemini:"Gemini",codex:"Codex",droid:"Droid",bedrock:"Bedrock",azure:"Azure",ccr:"CCR"};if(!r)return"Todos los servicios";let m=r;if(typeof r=="string"){if(r==="all"||r==="[]")return"Todos los servicios";try{m=JSON.parse(r)}catch{return s[r]||r}}return Array.isArray(m)&&m.length===0?"Todos los servicios":Array.isArray(m)?m.map(A=>s[A]||A).join(", "):s[r]||r},C=M(()=>{var m,A;const r=(A=(m=i.value)==null?void 0:m.accounts)==null?void 0:A.details;if(!r)return[];const s=[];return r.claude&&r.claude.accountType==="dedicated"&&s.push({key:"claude",...r.claude}),r.openai&&r.openai.accountType==="dedicated"&&s.push({key:"openai",...r.openai}),s}),j=M(()=>{const r=C.value.length;return r<=1?"md:grid-cols-1 lg:grid-cols-1":r===2?"md:grid-cols-2":"md:grid-cols-2 xl:grid-cols-3"}),E=r=>r?r.platform==="openai"?"OpenAI 专属账号":"Claude 专属账号":"专属账号",q=r=>{if(!r||r<=0)return"";const s=Math.floor(r),m=Math.floor(s/1440),A=Math.floor(s%1440/60),N=s%60;return m>0?A>0?`${m}天${A}小时`:`${m}天`:A>0?N>0?`${A}小时${N}分钟`:`${A}小时`:`${N}分钟`},F=r=>{if(!r)return{text:"EstadoDesconocido",class:"text-gray-400"};if(r.isRateLimited){const s=q(r.minutesRemaining);return{text:`限流en${s?` · 剩余约 ${s}`:""}`,class:"text-red-500 dark:text-red-400"}}return{text:"未限流",class:"text-green-600 dark:text-emerald-400"}},Q=(r,s)=>{if(!r||!s)return"Sin时间窗口Información";const m=new Date(r),A=new Date(s),N=B=>`${`${B.getHours()}`.padStart(2,"0")}:${`${B.getMinutes()}`.padStart(2,"0")}`;return`${N(m)} - ${N(A)}`},W=r=>{if(!r||r<=0)return"";const s=Math.floor(r/60),m=r%60;return s>0?`${s}小时${m}分钟`:`${m}分钟`},H=(r,s)=>{var A;if(!r)return"bg-gradient-to-r from-blue-500 to-indigo-500";if((A=s==null?void 0:s.rateLimitStatus)!=null&&A.isRateLimited)return"bg-gradient-to-r from-red-500 to-red-600";const m=String(r).toLowerCase();return m==="rejected"?"bg-gradient-to-r from-red-500 to-red-600":m==="allowed_warning"?"bg-gradient-to-r from-yellow-500 to-orange-500":"bg-gradient-to-r from-blue-500 to-indigo-500"},te=r=>{if(!r)return null;const s=typeof r.usedPercent=="number"&&!Number.isNaN(r.usedPercent)?r.usedPercent:null,m=typeof r.resetAfterSeconds=="number"&&!Number.isNaN(r.resetAfterSeconds)?r.resetAfterSeconds:null,A=typeof r.remainingSeconds=="number"?r.remainingSeconds:null,N=r.resetAt?Date.parse(r.resetAt):null;return m!==null&&(A!==null&&A<=0||N!==null&&!Number.isNaN(N)&&Date.now()>=N)?0:s===null?null:Math.max(0,Math.min(100,s))},oe=r=>{const s=te(r);return s===null?"bg-gradient-to-r from-gray-300 to-gray-400":s>=90?"bg-gradient-to-r from-red-500 to-red-600":s>=75?"bg-gradient-to-r from-yellow-500 to-orange-500":"bg-gradient-to-r from-emerald-500 to-teal-500"},ne=r=>{const s=te(r);return s===null?"0%":`${s}%`},Y=r=>{const s=te(r);return s===null?"--":`${s.toFixed(1)}%`},X=r=>{if(!r)return"--";let s=r.remainingSeconds;if(s==null&&(s=r.resetAfterSeconds),s==null||Number.isNaN(Number(s)))return"--";s=Math.max(0,Math.floor(Number(s)));const m=Math.floor(s/86400),A=Math.floor(s%86400/3600),N=Math.floor(s%3600/60),B=s%60;return m>0?A>0?`${m}天${A}小时`:`${m}天`:A>0?N>0?`${A}小时${N}分钟`:`${A}小时`:N>0?`${N}分钟`:`${B}秒`},G=r=>r==="secondary"?"周限":"5h";return(r,s)=>(a(),l("div",Kt,[e("div",It,[e("div",jt,[e("header",Lt,[e("i",{class:L(["header-icon",t(v)?"fas fa-layer-group text-purple-500":"fas fa-info-circle text-blue-500"])},null,2),e("h3",Pt,n(t(v)?"批量查询概要":"API Key Información"),1)]),t(v)&&t(h)?(a(),l("div",Rt,[e("div",Mt,[s[1]||(s[1]=e("p",{class:"info-label"},"查询 Keys 数",-1)),e("p",Et,n(t(h).totalKeys),1)]),e("div",Dt,[s[3]||(s[3]=e("p",{class:"info-label"},"Válido Keys 数",-1)),e("p",qt,[s[2]||(s[2]=e("i",{class:"fas fa-check-circle mr-1"},null,-1)),k(n(t(h).activeKeys),1)])]),t(I).length>0?(a(),l("div",Ut,[s[5]||(s[5]=e("p",{class:"info-label"},"Inválido Keys 数",-1)),e("p",Nt,[s[4]||(s[4]=e("i",{class:"fas fa-times-circle mr-1"},null,-1)),k(n(t(I).length),1)])])):b("",!0),e("div",Ot,[s[6]||(s[6]=e("p",{class:"info-label"},"totalRequests",-1)),e("p",Ft,n(t(O)(t(h).usage.requests)),1)]),e("div",Wt,[s[7]||(s[7]=e("p",{class:"info-label"},"总 Token 数",-1)),e("p",zt,n(t(O)(t(h).usage.allTokens)),1)]),e("div",Vt,[s[8]||(s[8]=e("p",{class:"info-label"},"totalCost",-1)),e("p",Bt,n(t(h).usage.formattedCost),1)]),t($).length>1?(a(),l("div",Ht,[s[9]||(s[9]=e("p",{class:"info-label"},"Top 3 贡献占比",-1)),e("div",Gt,[(a(!0),l(Z,null,se(P.value,m=>(a(),l("div",{key:m.apiId,class:"contributor-item"},[e("span",Jt,n(m.name),1),e("span",Qt,n(u(m))+"%",1)]))),128))])])):b("",!0)])):(a(),l("div",Yt,[e("div",{class:"info-item cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50",title:"点击Copiar",onClick:s[0]||(s[0]=m=>t(Ue)(t(i).name))},[s[11]||(s[11]=e("p",{class:"info-label"},"Nombre",-1)),e("p",Zt,[k(n(t(i).name)+" ",1),s[10]||(s[10]=e("i",{class:"fas fa-copy text-xs text-gray-400"},null,-1))])]),e("div",Xt,[s[12]||(s[12]=e("p",{class:"info-label"},"Estado",-1)),e("p",{class:L(["info-value font-semibold",t(i).isActive?"text-green-600 dark:text-emerald-400":"text-red-500 dark:text-red-400"])},[e("i",{class:L(["mr-1",t(i).isActive?"fas fa-check-circle":"fas fa-times-circle"])},null,2),k(" "+n(t(i).isActive?"活跃":"已停用"),1)],2)]),e("div",es,[s[13]||(s[13]=e("p",{class:"info-label"},"权限",-1)),e("p",ts,n(o(t(i).permissions)),1)]),w.value?(a(),l("div",ss,[s[14]||(s[14]=e("p",{class:"info-label"},"服务倍率",-1)),e("div",as,[(a(!0),l(Z,null,se(t(i).serviceRates,(m,A)=>(a(),l("span",{key:A,class:"inline-flex items-center rounded-full bg-purple-100 px-2.5 py-0.5 text-xs font-medium text-purple-800 dark:bg-purple-900/30 dark:text-purple-300"},n(A)+": "+n(m)+"x ",1))),128))])])):b("",!0),e("div",rs,[s[15]||(s[15]=e("p",{class:"info-label"},"Crear时间",-1)),e("p",ls,n(t(Ye)(t(i).createdAt)),1)]),e("div",os,[s[20]||(s[20]=e("p",{class:"info-label"},"过期时间",-1)),e("div",ns,[t(i).expirationMode==="activation"&&!t(i).isActivated?(a(),l(Z,{key:0},[s[16]||(s[16]=e("span",{class:"text-amber-600 dark:text-amber-400"},[e("i",{class:"fas fa-pause-circle mr-1"}),k("未激活 ")],-1)),e("span",is," 首veces使用siguiente "+n(t(i).activationDays||(t(i).activationUnit==="hours"?24:30))+" "+n(t(i).activationUnit==="hours"?"小时":"天")+"过期 ",1)],64)):t(i).expiresAt?(a(),l(Z,{key:1},[f(t(i).expiresAt)?(a(),l("span",ds,s[17]||(s[17]=[e("i",{class:"fas fa-exclamation-circle mr-1"},null,-1),k("已过期 ",-1)]))):c(t(i).expiresAt)?(a(),l("span",us,[s[18]||(s[18]=e("i",{class:"fas fa-clock mr-1"},null,-1)),k(n(x(t(i).expiresAt)),1)])):(a(),l("span",cs,n(x(t(i).expiresAt)),1))],64)):(a(),l("span",ms,s[19]||(s[19]=[e("i",{class:"fas fa-infinity mr-1"},null,-1),k("永不过期 ",-1)])))])])]))]),e("div",gs,[e("header",xs,[s[21]||(s[21]=e("i",{class:"header-icon fas fa-chart-bar text-green-500"},null,-1)),s[22]||(s[22]=e("h3",{class:"header-title"},"使用Estadísticas概览",-1)),e("span",ys,n(t(_)==="daily"?"Hoy":"Este mes"),1)]),e("div",fs,[e("div",ps,[e("p",vs,n(t(O)(t(g).requests)),1),e("p",bs,n(t(_)==="daily"?"Hoy":"Este mes")+"Solicitud数",1)]),e("div",ks,[e("p",hs,n(t(O)(t(g).allTokens)),1),e("p",_s,n(t(_)==="daily"?"Hoy":"Este mes")+"Token 数",1)]),e("div",ws,[e("p",$s,n(t(g).formattedCost||"$0.000000"),1),e("p",Cs,n(t(_)==="daily"?"Hoy":"Este mes")+"Costo",1)]),e("div",Ts,[e("p",Ss,n(t(O)(t(g).inputTokens)),1),e("p",As,n(t(_)==="daily"?"Hoy":"Este mes")+"Entrada Token",1)])])])]),!t(v)&&C.value.length>0?(a(),l("div",Ks,[s[24]||(s[24]=e("header",{class:"section-header"},[e("i",{class:"header-icon fas fa-plug text-indigo-500"}),e("h3",{class:"header-title"},"专属账号运行Estado"),e("span",{class:"header-tag"},"实时Actualizar")],-1)),e("div",{class:L(["grid grid-cols-1 gap-4",j.value])},[(a(!0),l(Z,null,se(C.value,m=>{var A,N,B,de,re,ie;return a(),l("div",{key:m.id||m.key,class:"account-card"},[e("div",Is,[e("div",js,[e("span",{class:L(["account-icon",m.platform==="claude"?"icon-claude":"icon-openai"])},[e("i",{class:L(m.platform==="claude"?"fas fa-meteor":"fas fa-robot")},null,2)],2),e("div",null,[e("p",Ls,n(E(m)),1),e("p",Ps,n(m.platform==="claude"?"会话窗口":"额度窗口"),1)])]),F(m.rateLimitStatus)?(a(),l("div",{key:0,class:L(["rate-badge",F(m.rateLimitStatus).class])},[s[23]||(s[23]=e("i",{class:"fas fa-tachometer-alt mr-1"},null,-1)),k(" "+n(F(m.rateLimitStatus).text),1)],2)):b("",!0)]),m.platform==="claude"?(a(),l("div",Rs,[e("div",Ms,[e("div",Es,[e("div",{class:L(["progress-bar",H((A=m.sessionWindow)==null?void 0:A.sessionWindowStatus,m)]),style:be({width:`${Math.min(100,Math.max(0,((N=m.sessionWindow)==null?void 0:N.progress)||0))}%`})},null,6)]),e("span",Ds,n(Math.min(100,Math.max(0,Math.round(((B=m.sessionWindow)==null?void 0:B.progress)||0))))+"% ",1)]),e("div",qs,[e("span",null,n(Q((de=m.sessionWindow)==null?void 0:de.windowStart,(re=m.sessionWindow)==null?void 0:re.windowEnd)),1),((ie=m.sessionWindow)==null?void 0:ie.remainingTime)>0?(a(),l("span",Us," 剩余 "+n(W(m.sessionWindow.remainingTime)),1)):b("",!0)])])):m.platform==="openai"?(a(),l("div",Ns,[m.codexUsage?(a(),l("div",Os,[(a(),l(Z,null,se(["primary","secondary"],J=>{var ae,ue,ye,fe;return e("div",{key:`${m.key}-${J}`,class:"quota-row"},[e("div",Fs,[e("span",{class:L(["quota-tag",J==="primary"?"tag-indigo":"tag-blue"])},n(G(J)),3),e("span",Ws,n(Y((ae=m.codexUsage)==null?void 0:ae[J])),1)]),e("div",zs,[e("div",{class:L(["progress-bar",oe((ue=m.codexUsage)==null?void 0:ue[J])]),style:be({width:ne((ye=m.codexUsage)==null?void 0:ye[J])})},null,6)]),e("div",Vs," Restablecer剩余 "+n(X((fe=m.codexUsage)==null?void 0:fe[J])),1)])}),64))])):(a(),l("p",Bs," Sin额度使用数据 "))])):b("",!0)])}),128))],2)])):b("",!0)]))}},Gs=me(Hs,[["__scopeId","data-v-fbbb7cf0"]]),Js={class:"card p-3 sm:p-4 md:p-6"},Qs={class:"mb-2 flex flex-col text-base font-bold text-gray-900 dark:text-gray-100 sm:mb-3 sm:flex-row sm:items-center sm:text-lg md:mb-4 md:text-xl"},Ys={class:"text-xs font-normal text-gray-600 dark:text-gray-400 sm:ml-2 md:text-sm"},Zs={class:"space-y-2 md:space-y-3"},Xs={class:"flex items-center justify-between"},ea={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},ta={class:"flex items-center justify-between"},sa={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},aa={class:"flex items-center justify-between"},ra={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},la={class:"flex items-center justify-between"},oa={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},na={class:"mt-3 border-t border-gray-200 pt-3 dark:border-gray-700 md:mt-4 md:pt-4"},ia={class:"flex items-center justify-between font-bold text-gray-900 dark:text-gray-100"},da={class:"text-sm md:text-base"},ua={class:"text-lg md:text-xl"},ca={__name:"TokenDistribution",setup(U){const K=ge(),{statsPeriod:i,currentPeriodData:_}=ce(K);return(g,v)=>(a(),l("div",Js,[e("h3",Qs,[v[0]||(v[0]=e("span",{class:"flex items-center"},[e("i",{class:"fas fa-coins mr-2 text-sm text-yellow-500 md:mr-3 md:text-base"}),k(" Distribución de Tokens ")],-1)),e("span",Ys,"("+n(t(i)==="daily"?"Hoy":"Este mes")+")",1)]),e("div",Zs,[e("div",Xs,[v[1]||(v[1]=e("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[e("i",{class:"fas fa-arrow-right mr-1 text-xs text-green-500 md:mr-2 md:text-sm"}),k(" Tokens de Entrada ")],-1)),e("span",ea,n(t(O)(t(_).inputTokens)),1)]),e("div",ta,[v[2]||(v[2]=e("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[e("i",{class:"fas fa-arrow-left mr-1 text-xs text-blue-500 md:mr-2 md:text-sm"}),k(" Tokens de Salida ")],-1)),e("span",sa,n(t(O)(t(_).outputTokens)),1)]),e("div",aa,[v[3]||(v[3]=e("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[e("i",{class:"fas fa-save mr-1 text-xs text-purple-500 md:mr-2 md:text-sm"}),k(" Tokens de Creación de Cache ")],-1)),e("span",ra,n(t(O)(t(_).cacheCreateTokens)),1)]),e("div",la,[v[4]||(v[4]=e("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[e("i",{class:"fas fa-download mr-1 text-xs text-orange-500 md:mr-2 md:text-sm"}),k(" Caché lectura Token ")],-1)),e("span",oa,n(t(O)(t(_).cacheReadTokens)),1)])]),e("div",na,[e("div",ia,[e("span",da,n(t(i)==="daily"?"Hoy":"Este mes")+"Total",1),e("span",ua,n(t(O)(t(_).allTokens)),1)])])]))}},ma=me(ca,[["__scopeId","data-v-07ca66c8"]]),ga={class:"flex h-full flex-col gap-3 sm:gap-4 md:gap-6"},xa={class:"card flex h-full flex-col p-3 sm:p-4 md:p-6"},ya={class:"mb-2 flex items-center text-base font-bold text-gray-900 dark:text-gray-100 sm:mb-3 sm:text-lg md:mb-4 md:text-xl"},fa={key:0,class:"space-y-4"},pa={class:"rounded-lg bg-gradient-to-r from-blue-50 to-indigo-50 p-4 dark:from-blue-900/20 dark:to-indigo-900/20"},va={class:"mb-3 flex items-center justify-between"},ba={class:"rounded-full bg-blue-100 px-2 py-1 text-xs font-semibold text-blue-700 dark:bg-blue-800 dark:text-blue-200"},ka={class:"grid grid-cols-2 gap-3"},ha={class:"text-center"},_a={class:"text-lg font-bold text-gray-900 dark:text-gray-100"},wa={class:"text-center"},$a={class:"text-lg font-bold text-green-600"},Ca={class:"rounded-lg bg-gradient-to-r from-purple-50 to-pink-50 p-4 dark:from-purple-900/20 dark:to-pink-900/20"},Ta={class:"space-y-2"},Sa={class:"flex items-center justify-between"},Aa={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},Ka={class:"flex items-center justify-between"},Ia={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},ja={class:"flex items-center justify-between"},La={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},Pa={key:0,class:"rounded-lg bg-red-50 p-3 text-sm dark:bg-red-900/20"},Ra={class:"text-red-700 dark:text-red-300"},Ma={key:1,class:"space-y-4 md:space-y-5"},Ea={class:"mb-2 flex items-center justify-between"},Da={class:"text-xs text-gray-500 dark:text-gray-400 md:text-sm"},qa={key:0},Ua={key:1,class:"flex items-center gap-1"},Na={key:0,class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},Oa={key:1,class:"h-2 w-full rounded-full bg-gray-200"},Fa={class:"mb-2 flex items-center justify-between"},Wa={class:"text-xs text-gray-500 dark:text-gray-400 md:text-sm"},za={key:0},Va={key:1,class:"flex items-center gap-1"},Ba={key:0,class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},Ha={key:1,class:"h-2 w-full rounded-full bg-gray-200"},Ga={key:0},Ja={class:"mb-2 flex items-center justify-between"},Qa={class:"text-xs text-gray-500 dark:text-gray-400 md:text-sm"},Ya={class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},Za={key:1},Xa={class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},er={key:0},tr={key:1},sr={key:2},ar={class:"space-y-4 border-t border-gray-100 pt-3 dark:border-gray-700"},rr={class:"flex items-center justify-between"},lr={class:"text-sm font-medium text-gray-900 md:text-base"},or={key:0},nr={key:1,class:"flex items-center gap-1"},ir={class:"flex items-center justify-between"},dr={class:"text-sm font-medium text-gray-900 md:text-base"},ur={key:0,class:"text-orange-600"},cr={key:1,class:"text-green-600"},mr={class:"space-y-2"},gr={class:"flex items-center justify-between"},xr={class:"text-sm font-medium text-gray-900 md:text-base"},yr={key:0,class:"text-orange-600"},fr={key:1,class:"text-green-600"},pr={key:0,class:"flex flex-wrap gap-2 rounded-lg bg-blue-50 p-2 dark:bg-blue-900/20 md:p-3"},vr={key:0,class:"card !overflow-visible p-4 md:p-6"},br={class:"rounded-lg border border-amber-200 bg-amber-50 p-3 dark:border-amber-800 dark:bg-amber-900/20 md:p-4"},kr={class:"max-h-64 space-y-1 overflow-y-auto pr-1 md:max-h-80 md:space-y-2"},hr={class:"break-all text-gray-800 dark:text-gray-200"},_r={__name:"LimitConfig",setup(U){const K=ge(),{statsData:i,multiKeyMode:_,aggregatedStats:g,invalidKeys:v}=ce(K),h=M(()=>{var o;const c=(o=i.value)==null?void 0:o.restrictions;return c?c.enableModelRestriction===!0&&Array.isArray(c.restrictedModels)&&c.restrictedModels.length>0:!1}),$=M(()=>{var o;const c=(o=i.value)==null?void 0:o.restrictions;return c?c.enableClientRestriction===!0&&Array.isArray(c.allowedClients)&&c.allowedClients.length>0:!1}),I=()=>{if(!i.value.limits.dailyCostLimit||i.value.limits.dailyCostLimit===0)return 0;const c=i.value.limits.currentDailyCost/i.value.limits.dailyCostLimit*100;return Math.min(c,100)},P=()=>{const c=I();return c>=100?"bg-red-500":c>=80?"bg-yellow-500":"bg-green-500"},w=()=>{if(!i.value.limits.totalCostLimit||i.value.limits.totalCostLimit===0)return 0;const c=i.value.limits.currentTotalCost/i.value.limits.totalCostLimit*100;return Math.min(c,100)},u=()=>{const c=w();return c>=100?"bg-red-500":c>=80?"bg-yellow-500":"bg-blue-500"},x=()=>{if(!i.value.limits.weeklyOpusCostLimit||i.value.limits.weeklyOpusCostLimit===0)return 0;const c=i.value.limits.weeklyOpusCost/i.value.limits.weeklyOpusCostLimit*100;return Math.min(c,100)},f=()=>{const c=x();return c>=100?"bg-red-500":c>=80?"bg-yellow-500":"bg-indigo-500"};return(c,o)=>{var C;return a(),l("div",ga,[e("div",xa,[e("h3",ya,[o[0]||(o[0]=e("i",{class:"fas fa-shield-alt mr-2 text-sm text-red-500 md:mr-3 md:text-base"},null,-1)),k(" "+n(t(_)?"Configuración de límites (modo de consulta agregada)":"Configuración de límites"),1)]),t(_)&&t(g)?(a(),l("div",fa,[e("div",pa,[e("div",va,[o[1]||(o[1]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-layer-group mr-2 text-blue-500"}),k(" Resumen de API Keys ")],-1)),e("span",ba,n(t(g).activeKeys)+"/"+n(t(g).totalKeys),1)]),e("div",ka,[e("div",ha,[e("div",_a,n(t(g).totalKeys),1),o[2]||(o[2]=e("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Total de Keys",-1))]),e("div",wa,[e("div",$a,n(t(g).activeKeys),1),o[3]||(o[3]=e("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Keys activas",-1))])])]),e("div",Ca,[o[7]||(o[7]=e("div",{class:"mb-3 flex items-center"},[e("i",{class:"fas fa-chart-pie mr-2 text-purple-500"}),e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Resumen de estadísticas agregadas")],-1)),e("div",Ta,[e("div",Sa,[o[4]||(o[4]=e("span",{class:"text-xs text-gray-600 dark:text-gray-400"},[e("i",{class:"fas fa-database mr-1 text-gray-400"}),k(" totalRequests ")],-1)),e("span",Aa,n(t(O)(t(g).usage.requests)),1)]),e("div",Ka,[o[5]||(o[5]=e("span",{class:"text-xs text-gray-600 dark:text-gray-400"},[e("i",{class:"fas fa-coins mr-1 text-yellow-500"}),k(" Tokens totales ")],-1)),e("span",Ia,n(t(O)(t(g).usage.allTokens)),1)]),e("div",ja,[o[6]||(o[6]=e("span",{class:"text-xs text-gray-600 dark:text-gray-400"},[e("i",{class:"fas fa-dollar-sign mr-1 text-green-500"}),k(" totalCost ")],-1)),e("span",La,n(t(g).usage.formattedCost),1)])])]),t(v)&&t(v).length>0?(a(),l("div",Pa,[o[8]||(o[8]=e("i",{class:"fas fa-exclamation-triangle mr-2 text-red-600 dark:text-red-400"},null,-1)),e("span",Ra,n(t(v).length)+" API Keys inválidas ",1)])):b("",!0),o[9]||(o[9]=e("div",{class:"rounded-lg bg-gray-50 p-3 text-xs text-gray-600 dark:bg-gray-800 dark:text-gray-400"},[e("i",{class:"fas fa-info-circle mr-1"}),k(" Cada API Key tiene su propia configuración de límites, en modo agregado no se muestra la configuración individual ")],-1))])):b("",!0),!t(_)&&((C=t(i))!=null&&C.limits)?(a(),l("div",Ma,[e("div",null,[e("div",Ea,[o[11]||(o[11]=e("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400 md:text-base"},"Límite de costo diario",-1)),e("span",Da,[t(i).limits.dailyCostLimit>0?(a(),l("span",qa," $"+n(t(i).limits.currentDailyCost.toFixed(4))+" / $"+n(t(i).limits.dailyCostLimit.toFixed(2)),1)):(a(),l("span",Ua,[k(" $"+n(t(i).limits.currentDailyCost.toFixed(4))+" / ",1),o[10]||(o[10]=e("i",{class:"fas fa-infinity"},null,-1))]))])]),t(i).limits.dailyCostLimit>0?(a(),l("div",Na,[e("div",{class:L(["h-2 rounded-full transition-all duration-300",P()]),style:be({width:I()+"%"})},null,6)])):(a(),l("div",Oa,o[12]||(o[12]=[e("div",{class:"h-2 rounded-full bg-green-500",style:{width:"0%"}},null,-1)])))]),e("div",null,[e("div",Fa,[o[14]||(o[14]=e("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400 md:text-base"},"Límite de costo total",-1)),e("span",Wa,[t(i).limits.totalCostLimit>0?(a(),l("span",za," $"+n(t(i).limits.currentTotalCost.toFixed(4))+" / $"+n(t(i).limits.totalCostLimit.toFixed(2)),1)):(a(),l("span",Va,[k(" $"+n(t(i).limits.currentTotalCost.toFixed(4))+" / ",1),o[13]||(o[13]=e("i",{class:"fas fa-infinity"},null,-1))]))])]),t(i).limits.totalCostLimit>0?(a(),l("div",Ba,[e("div",{class:L(["h-2 rounded-full transition-all duration-300",u()]),style:be({width:w()+"%"})},null,6)])):(a(),l("div",Ha,o[15]||(o[15]=[e("div",{class:"h-2 rounded-full bg-blue-500",style:{width:"0%"}},null,-1)])))]),t(i).limits.weeklyOpusCostLimit>0?(a(),l("div",Ga,[e("div",Ja,[o[16]||(o[16]=e("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400 md:text-base"},"Límite de costo semanal de modelos Claude",-1)),e("span",Qa," $"+n(t(i).limits.weeklyOpusCost.toFixed(4))+" / $"+n(t(i).limits.weeklyOpusCostLimit.toFixed(2)),1)]),e("div",Ya,[e("div",{class:L(["h-2 rounded-full transition-all duration-300",f()]),style:be({width:x()+"%"})},null,6)])])):b("",!0),t(i).limits.rateLimitWindow>0&&(t(i).limits.rateLimitRequests>0||t(i).limits.tokenLimit>0||t(i).limits.rateLimitCost>0)?(a(),l("div",Za,[ee(ot,{"cost-limit":t(i).limits.rateLimitCost,"current-cost":t(i).limits.currentWindowCost,"current-requests":t(i).limits.currentWindowRequests,"current-tokens":t(i).limits.currentWindowTokens,label:"Límite de ventana de tiempo","rate-limit-window":t(i).limits.rateLimitWindow,"request-limit":t(i).limits.rateLimitRequests,"show-progress":!0,"show-tooltip":!0,"token-limit":t(i).limits.tokenLimit,"window-end-time":t(i).limits.windowEndTime,"window-remaining-seconds":t(i).limits.windowRemainingSeconds,"window-start-time":t(i).limits.windowStartTime},null,8,["cost-limit","current-cost","current-requests","current-tokens","rate-limit-window","request-limit","token-limit","window-end-time","window-remaining-seconds","window-start-time"]),e("div",Xa,[o[17]||(o[17]=e("i",{class:"fas fa-info-circle mr-1"},null,-1)),t(i).limits.rateLimitCost>0?(a(),l("span",er,' Las solicitudes y el límite de costo son una relación "O", se activa el limitante cuando se alcance cualquiera de los dos ')):t(i).limits.tokenLimit>0?(a(),l("span",tr,' Las solicitudes y el uso de tokens son una relación "O", se activa el limitante cuando se alcance cualquiera de los dos ')):(a(),l("span",sr," Solo limitar solicitudes "))])])):b("",!0),e("div",ar,[e("div",rr,[o[19]||(o[19]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"Límite de concurrencia",-1)),e("span",lr,[t(i).limits.concurrencyLimit>0?(a(),l("span",or,n(t(i).limits.concurrencyLimit),1)):(a(),l("span",nr,o[18]||(o[18]=[e("i",{class:"fas fa-infinity text-gray-400"},null,-1)])))])]),e("div",ir,[o[22]||(o[22]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"Límite de modelos",-1)),e("span",dr,[h.value?(a(),l("span",ur,[o[20]||(o[20]=e("i",{class:"fas fa-exclamation-triangle mr-1 text-xs md:text-sm"},null,-1)),k(" "+n(t(i).restrictions.restrictedModels.length)+" modelos restringidos ",1)])):(a(),l("span",cr,o[21]||(o[21]=[e("i",{class:"fas fa-check-circle mr-1 text-xs md:text-sm"},null,-1),k(" Todos los modelos permitidos ",-1)])))])]),e("div",mr,[e("div",gr,[o[25]||(o[25]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"Límite de clientes",-1)),e("span",xr,[$.value?(a(),l("span",yr,[o[23]||(o[23]=e("i",{class:"fas fa-exclamation-triangle mr-1 text-xs md:text-sm"},null,-1)),k(" "+n(t(i).restrictions.allowedClients.length)+" tipos de clientes permitidos ",1)])):(a(),l("span",fr,o[24]||(o[24]=[e("i",{class:"fas fa-check-circle mr-1 text-xs md:text-sm"},null,-1),k(" Todos los clientes permitidos ",-1)])))])]),$.value?(a(),l("div",pr,[(a(!0),l(Z,null,se(t(i).restrictions.allowedClients,j=>(a(),l("span",{key:j,class:"flex items-center gap-1 rounded-full bg-white px-2 py-1 text-xs text-blue-700 shadow-sm dark:bg-gray-800 dark:text-blue-300 md:text-sm"},[o[26]||(o[26]=e("i",{class:"fas fa-id-badge"},null,-1)),k(" "+n(j),1)]))),128))])):b("",!0)])])])):b("",!0)]),h.value?(a(),l("div",vr,[o[30]||(o[30]=e("h3",{class:"mb-3 flex items-center text-lg font-bold text-gray-900 dark:text-gray-100 md:mb-4 md:text-xl"},[e("i",{class:"fas fa-list-alt mr-2 text-sm text-amber-500 md:mr-3 md:text-base"}),k(" Información detallada de límites ")],-1)),e("div",br,[o[28]||(o[28]=e("h4",{class:"mb-2 flex items-center text-sm font-bold text-amber-800 dark:text-amber-300 md:mb-3 md:text-base"},[e("i",{class:"fas fa-robot mr-1 text-xs md:mr-2 md:text-sm"}),k(" Lista de modelos restringidos ")],-1)),e("div",kr,[(a(!0),l(Z,null,se(t(i).restrictions.restrictedModels,j=>(a(),l("div",{key:j,class:"rounded border border-amber-200 bg-white px-2 py-1 text-xs dark:border-amber-700 dark:bg-gray-800 md:px-3 md:py-2 md:text-sm"},[o[27]||(o[27]=e("i",{class:"fas fa-ban mr-1 text-xs text-red-500 md:mr-2"},null,-1)),e("span",hr,n(j),1)]))),128))]),o[29]||(o[29]=e("p",{class:"mt-2 text-xs text-amber-700 dark:text-amber-400 md:mt-3"},[e("i",{class:"fas fa-info-circle mr-1"}),k(" Esta API Key no puede acceder a los modelos listados arriba ")],-1))])])):b("",!0)])}}},wr=me(_r,[["__scopeId","data-v-af75f43f"]]),$r={class:"card h-full p-4 md:p-6"},Cr={class:"mb-3 flex flex-col text-lg font-bold text-gray-900 dark:text-gray-100 sm:flex-row sm:items-center md:mb-4 md:text-xl"},Tr={class:"text-xs font-normal text-gray-600 dark:text-gray-400 sm:ml-2 md:text-sm"},Sr={key:0,class:"space-y-2 md:space-y-3"},Ar={class:"mb-1 flex items-center justify-between text-sm"},Kr={class:"truncate font-medium text-gray-700 dark:text-gray-300"},Ir={class:"text-xs text-gray-600 dark:text-gray-400"},jr={class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},Lr={class:"mt-1 flex items-center justify-between text-xs text-gray-500 dark:text-gray-400"},Pr={key:0,class:"border-t border-gray-200 pt-2 dark:border-gray-700"},Rr={class:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400"},Mr={key:1,class:"flex h-32 items-center justify-center text-sm text-gray-500 dark:text-gray-400"},Er={key:2,class:"flex h-32 items-center justify-center text-sm text-gray-500 dark:text-gray-400"},Dr={__name:"AggregatedStatsCard",setup(U){const K=ge(),{aggregatedStats:i,individualStats:_,statsPeriod:g,multiKeyMode:v}=ce(K),h=x=>x?g.value==="daily"?x.dailyUsage||x.usage:x.monthlyUsage||x.usage:null,$=M(()=>!_.value||_.value.length===0?[]:[..._.value].sort((x,f)=>{const c=h(x),o=h(f);return((o==null?void 0:o.cost)||0)-((c==null?void 0:c.cost)||0)}).slice(0,5)),I=M(()=>_.value?Math.max(0,_.value.length-5):0),P=M(()=>{var o,C;if(!_.value||!i.value)return 0;const x=$.value.reduce((j,E)=>{const q=h(E);return j+((q==null?void 0:q.cost)||0)},0),f=g.value==="daily"?((o=i.value.dailyUsage)==null?void 0:o.cost)||0:((C=i.value.monthlyUsage)==null?void 0:C.cost)||0;if(f===0)return 0;const c=f-x;return Math.max(0,Math.round(c/f*100))}),w=x=>{var C,j;if(!i.value)return 0;const f=g.value==="daily"?((C=i.value.dailyUsage)==null?void 0:C.cost)||0:((j=i.value.monthlyUsage)==null?void 0:j.cost)||0;if(f===0)return 0;const c=h(x),o=((c==null?void 0:c.cost)||0)/f*100;return Math.round(o)},u=x=>["bg-blue-500","bg-green-500","bg-purple-500","bg-yellow-500","bg-pink-500"][x]||"bg-gray-400";return(x,f)=>(a(),l("div",$r,[e("h3",Cr,[f[0]||(f[0]=e("span",{class:"flex items-center"},[e("i",{class:"fas fa-chart-pie mr-2 text-sm text-orange-500 md:mr-3 md:text-base"}),k(" Uso por clave ")],-1)),e("span",Tr,"("+n(t(g)==="daily"?"Hoy":"Este mes")+")",1)]),t(i)&&t(_).length>0?(a(),l("div",Sr,[(a(!0),l(Z,null,se($.value,(c,o)=>{var C,j;return a(),l("div",{key:c.apiId,class:"relative"},[e("div",Ar,[e("span",Kr,n(c.name||`Key ${o+1}`),1),e("span",Ir,n(w(c))+"% ",1)]),e("div",jr,[e("div",{class:L(["h-2 rounded-full transition-all duration-300",u(o)]),style:be({width:w(c)+"%"})},null,6)]),e("div",Lr,[e("span",null,n(t(O)(((C=h(c))==null?void 0:C.requests)||0))+" solicitudes",1),e("span",null,n(((j=h(c))==null?void 0:j.formattedCost)||"$0.00"),1)])])}),128)),I.value>0?(a(),l("div",Pr,[e("div",Rr,[e("span",null,"Otras "+n(I.value)+" claves",1),e("span",null,n(P.value)+"%",1)])])):b("",!0)])):t(v)?(a(),l("div",Er,f[2]||(f[2]=[e("i",{class:"fas fa-chart-pie mr-2"},null,-1),k(" Sin datos por ahora ",-1)]))):(a(),l("div",Mr,f[1]||(f[1]=[e("div",{class:"text-center"},[e("i",{class:"fas fa-chart-pie mb-2 text-2xl"}),e("p",null,"El uso por clave solo se muestra en consultas de múltiples claves")],-1)])))]))}},qr=me(Dr,[["__scopeId","data-v-cce4ca86"]]),Ur={class:"card p-3 sm:p-4 md:p-6"},Nr={class:"mb-2 sm:mb-3 md:mb-4"},Or={class:"flex flex-col text-base font-bold text-gray-900 dark:text-gray-100 sm:flex-row sm:items-center sm:text-lg md:text-xl"},Fr={class:"text-xs font-normal text-gray-600 dark:text-gray-400 sm:ml-2 md:text-sm"},Wr={key:0,class:"py-6 text-center md:py-8"},zr={key:1,class:"space-y-2"},Vr={class:"flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between"},Br={class:"flex flex-col gap-1 sm:flex-row sm:items-center sm:gap-3"},Hr=["onClick"],Gr={class:"flex flex-wrap gap-x-2 text-xs text-gray-500 dark:text-gray-400"},Jr={key:0},Qr={key:1},Yr={class:"flex-shrink-0 text-xs sm:text-sm"},Zr={class:"ml-1 font-semibold text-green-600"},Xr={class:"ml-1 font-semibold text-amber-600 dark:text-amber-400"},el={key:2,class:"py-6 text-center text-gray-500 dark:text-gray-400 md:py-8"},tl={class:"text-sm md:text-base"},sl={__name:"ModelUsageStats",props:{period:{type:String,default:"daily",validator:U=>["daily","monthly","alltime"].includes(U)}},setup(U){const K=U,i=ge(),{dailyModelStats:_,monthlyModelStats:g,alltimeModelStats:v,modelStatsLoading:h,serviceRates:$}=ce(i),I=M(()=>K.period==="daily"?_.value:K.period==="monthly"?g.value:K.period==="alltime"?v.value:[]),P=M(()=>h.value),w=M(()=>K.period==="daily"?"Hoy":K.period==="monthly"?"Este mes":K.period==="alltime"?"Todos los tiempos":""),u=c=>Ue(c,"Nombre del modelo已Copiar"),x=c=>{if(!c)return"claude";const o=c.toLowerCase();return o.includes("claude")||o.includes("sonnet")||o.includes("opus")||o.includes("haiku")?"claude":o.includes("gpt")||o.includes("o1")||o.includes("o3")||o.includes("o4")?"codex":o.includes("gemini")?"gemini":o.includes("droid")||o.includes("factory")?"droid":o.includes("bedrock")||o.includes("amazon")?"bedrock":o.includes("azure")?"azure":"claude"},f=c=>{var q,F,Q;if(!c.isLegacy&&((q=c.costs)==null?void 0:q.rated)!==void 0){const W=c.costs.rated;return W>=1?"$"+W.toFixed(2):W>=.01?"$"+W.toFixed(4):"$"+W.toFixed(6)}const o=((F=c.costs)==null?void 0:F.total)||0;if(!o||!((Q=$.value)!=null&&Q.rates))return"$0.00";const C=x(c.model),j=$.value.rates[C]||1,E=o*j;return E>=1?"$"+E.toFixed(2):E>=.01?"$"+E.toFixed(4):"$"+E.toFixed(6)};return(c,o)=>(a(),l("div",Ur,[e("div",Nr,[e("h3",Or,[o[0]||(o[0]=e("span",{class:"flex items-center"},[e("i",{class:"fas fa-robot mr-2 text-sm text-indigo-500 md:mr-3 md:text-base"}),k(" Estadísticas de uso del modelo ")],-1)),e("span",Fr,"("+n(w.value)+")",1)])]),P.value?(a(),l("div",Wr,o[1]||(o[1]=[e("i",{class:"fas fa-spinner loading-spinner mb-2 text-xl text-gray-600 dark:text-gray-400 md:text-2xl"},null,-1),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"Cargando estadísticas del modelo...",-1)]))):I.value.length>0?(a(),l("div",zr,[(a(!0),l(Z,null,se(I.value,(C,j)=>{var E,q;return a(),l("div",{key:j,class:"model-usage-item"},[e("div",Vr,[e("div",Br,[e("h4",{class:"cursor-pointer text-sm font-bold text-gray-900 hover:text-indigo-600 dark:text-gray-100 dark:hover:text-indigo-400",title:"Haz clic para copiar",onClick:F=>u(C.model)},[k(n(C.model)+" ",1),o[2]||(o[2]=e("i",{class:"fas fa-copy ml-1 text-xs text-gray-400"},null,-1))],8,Hr),e("div",Gr,[e("span",null,n(C.requests)+"veces",1),e("span",null,"Entrada:"+n(t(O)(C.inputTokens)),1),e("span",null,"Salida:"+n(t(O)(C.outputTokens)),1),C.cacheCreateTokens?(a(),l("span",Jr,"Caché creac:"+n(t(O)(C.cacheCreateTokens)),1)):b("",!0),C.cacheReadTokens?(a(),l("span",Qr,"Caché lect:"+n(t(O)(C.cacheReadTokens)),1)):b("",!0)])]),e("div",Yr,[o[4]||(o[4]=e("span",{class:"text-gray-500"},"API oficial",-1)),e("span",Zr,n(((E=C.formatted)==null?void 0:E.total)||"$0.00"),1),(q=t($))!=null&&q.rates?(a(),l(Z,{key:0},[o[3]||(o[3]=e("span",{class:"ml-2 text-gray-500"},"Facturación",-1)),e("span",Xr,n(f(C)),1)],64)):b("",!0)])])])}),128))])):(a(),l("div",el,[o[5]||(o[5]=e("i",{class:"fas fa-chart-pie mb-3 text-2xl md:text-3xl"},null,-1)),e("p",tl,"Sin"+n(w.value)+"Uso del modelo数据",1)]))]))}},we=me(sl,[["__scopeId","data-v-f5c21911"]]),al={key:0,class:"card p-3 sm:p-4 md:p-6"},rl={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},ll={class:"mb-2 flex items-center justify-between"},ol={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},nl={class:"flex items-center gap-1"},il={class:"rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",title:"Global倍率"},dl={key:0,class:"rounded-full bg-purple-100 px-2 py-0.5 text-xs font-medium text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",title:"Key倍率"},ul={class:"mb-2 space-y-0.5 text-xs text-gray-600 dark:text-gray-400"},cl={class:"flex justify-between"},ml={class:"text-gray-900 dark:text-gray-200"},gl={class:"flex justify-between"},xl={class:"text-gray-900 dark:text-gray-200"},yl={key:0,class:"flex justify-between"},fl={class:"text-gray-900 dark:text-gray-200"},pl={key:1,class:"flex justify-between"},vl={class:"text-gray-900 dark:text-gray-200"},bl={class:"mb-2 space-y-0.5 border-t border-gray-200 pt-2 text-xs dark:border-gray-700"},kl={class:"flex justify-between"},hl={class:"font-semibold text-green-600 dark:text-green-400"},_l={class:"flex justify-between"},wl={class:"font-semibold text-amber-600 dark:text-amber-400"},$l={key:0,class:"space-y-0.5 border-t border-gray-200 pt-2 text-xs text-gray-500 dark:border-gray-700 dark:text-gray-500"},Cl={class:"flex justify-between"},Tl={class:"flex justify-between"},Sl={key:0,class:"flex justify-between"},Al={key:1,class:"flex justify-between"},Kl={__name:"ServiceCostCards",setup(U){const K=ge(),{modelStats:i,serviceRates:_,keyServiceRates:g,multiKeyMode:v}=ce(K),h={claude:"Claude",codex:"Codex",gemini:"Gemini",droid:"Droid",bedrock:"Bedrock",azure:"Azure",ccr:"CCR"},$=w=>{if(!w)return"claude";const u=w.toLowerCase();return u.includes("claude")||u.includes("sonnet")||u.includes("opus")||u.includes("haiku")?"claude":u.includes("gpt")||u.includes("o1")||u.includes("o3")||u.includes("o4")?"codex":u.includes("gemini")?"gemini":u.includes("droid")||u.includes("factory")?"droid":u.includes("bedrock")||u.includes("amazon")?"bedrock":u.includes("azure")?"azure":"claude"},I=M(()=>{var u,x;if(!((u=_.value)!=null&&u.rates)||!((x=i.value)!=null&&x.length))return[];const w={};return Object.keys(_.value.rates).forEach(f=>{w[f]={inputTokens:0,outputTokens:0,cacheCreateTokens:0,cacheReadTokens:0,realCost:0,ratedCost:0,pricing:null}}),i.value.forEach(f=>{var o,C,j,E;const c=$(f.model);if(w[c]){w[c].inputTokens+=f.inputTokens||0,w[c].outputTokens+=f.outputTokens||0,w[c].cacheCreateTokens+=f.cacheCreateTokens||0,w[c].cacheReadTokens+=f.cacheReadTokens||0;const q=((o=f.costs)==null?void 0:o.real)??((C=f.costs)==null?void 0:C.total)??0;w[c].realCost+=q;const F=_.value.rates[c]||1,Q=v.value?1:((j=g.value)==null?void 0:j[c])??1,W=!f.isLegacy&&((E=f.costs)==null?void 0:E.rated)!==void 0?f.costs.rated:q*F*Q;w[c].ratedCost+=W,!w[c].pricing&&f.pricing&&(w[c].pricing=f.pricing)}}),Object.entries(w).filter(([,f])=>f.inputTokens>0||f.outputTokens>0||f.cacheCreateTokens>0||f.realCost>0).map(([f,c])=>{var E;const o=_.value.rates[f]||1,C=v.value?1:((E=g.value)==null?void 0:E[f])??1,j=c.pricing;return{name:f,label:h[f]||f,globalRate:o,keyRate:C,inputTokens:c.inputTokens,outputTokens:c.outputTokens,cacheCreateTokens:c.cacheCreateTokens,cacheReadTokens:c.cacheReadTokens,officialCost:P(c.realCost),ccCost:P(c.ratedCost),pricing:j?{input:P(j.input),output:P(j.output),cacheCreate:j.cacheCreate?P(j.cacheCreate):null,cacheRead:j.cacheRead?P(j.cacheRead):null}:null}}).sort((f,c)=>c.inputTokens+c.outputTokens-(f.inputTokens+f.outputTokens))}),P=w=>!w||w===0?"$0.00":w>=1?"$"+w.toFixed(2):w>=.01?"$"+w.toFixed(4):"$"+w.toFixed(6);return(w,u)=>t(_)&&t(i).length>0?(a(),l("div",al,[u[10]||(u[10]=e("h3",{class:"mb-2 flex items-center justify-between text-base font-bold text-gray-900 dark:text-gray-100 sm:mb-3 sm:text-lg md:mb-4 md:text-xl"},[e("span",{class:"flex items-center"},[e("i",{class:"fas fa-coins mr-2 text-sm text-amber-500 md:mr-3 md:text-base"}),k(" Estadísticas de costos de servicio ")]),e("span",{class:"text-xs font-normal text-gray-500 dark:text-gray-400"}," Facturación = Costo oficial × Tasa global × Tasa de Key ")],-1)),e("div",rl,[(a(!0),l(Z,null,se(I.value,x=>(a(),l("div",{key:x.name,class:"rounded-xl border border-gray-200 bg-gray-50 p-3 dark:border-gray-700 dark:bg-gray-800/50"},[e("div",ll,[e("span",ol,n(x.label),1),e("div",nl,[e("span",il," Global "+n(x.globalRate)+"x ",1),t(v)?b("",!0):(a(),l("span",dl," Key "+n(x.keyRate)+"x ",1))])]),e("div",ul,[e("div",cl,[u[0]||(u[0]=e("span",null,"Entrada",-1)),e("span",ml,n(t(O)(x.inputTokens)),1)]),e("div",gl,[u[1]||(u[1]=e("span",null,"Salida",-1)),e("span",xl,n(t(O)(x.outputTokens)),1)]),x.cacheCreateTokens?(a(),l("div",yl,[u[2]||(u[2]=e("span",null,"Caché creación",-1)),e("span",fl,n(t(O)(x.cacheCreateTokens)),1)])):b("",!0),x.cacheReadTokens?(a(),l("div",pl,[u[3]||(u[3]=e("span",null,"Caché lectura",-1)),e("span",vl,n(t(O)(x.cacheReadTokens)),1)])):b("",!0)]),e("div",bl,[e("div",kl,[u[4]||(u[4]=e("span",{class:"text-gray-600 dark:text-gray-400"},"API oficial",-1)),e("span",hl,n(x.officialCost),1)]),e("div",_l,[u[5]||(u[5]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Costo facturado",-1)),e("span",wl,n(x.ccCost),1)])]),x.pricing?(a(),l("div",$l,[e("div",Cl,[u[6]||(u[6]=e("span",null,"Entrada",-1)),e("span",null,n(x.pricing.input)+"/M",1)]),e("div",Tl,[u[7]||(u[7]=e("span",null,"Salida",-1)),e("span",null,n(x.pricing.output)+"/M",1)]),x.pricing.cacheCreate?(a(),l("div",Sl,[u[8]||(u[8]=e("span",null,"Caché creación",-1)),e("span",null,n(x.pricing.cacheCreate)+"/M",1)])):b("",!0),x.pricing.cacheRead?(a(),l("div",Al,[u[9]||(u[9]=e("span",null,"Caché lectura",-1)),e("span",null,n(x.pricing.cacheRead)+"/M",1)])):b("",!0)])):b("",!0)]))),128))])])):b("",!0)}},Il=me(Kl,[["__scopeId","data-v-7f51ea22"]]),jl={key:0,class:"fixed inset-0 z-[1050] flex items-center justify-center bg-gray-900/40 backdrop-blur-sm"},Ll={class:"relative z-10 mx-3 flex w-full max-w-lg flex-col overflow-hidden rounded-2xl border border-gray-200/70 bg-white/95 shadow-2xl ring-1 ring-black/5 transition-all dark:border-gray-700/60 dark:bg-gray-900/95 dark:ring-white/10 sm:mx-4"},Pl={class:"flex items-center justify-between border-b border-gray-100 bg-white/80 px-5 py-4 backdrop-blur dark:border-gray-800 dark:bg-gray-900/80"},Rl={class:"flex items-center gap-3"},Ml={class:"text-xs text-gray-500 dark:text-gray-400"},El=["disabled"],Dl={class:"max-h-[70vh] overflow-y-auto px-5 py-4"},ql={class:"mb-4"},Ul={class:"relative"},Nl=["value"],Ol={class:"mb-4 space-y-2"},Fl={class:"flex items-center justify-between text-sm"},Wl={class:"inline-flex items-center gap-1.5 rounded-full bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-700 dark:bg-blue-500/20 dark:text-blue-300"},zl={class:"text-sm"},Vl={class:"mb-1 flex items-center justify-between"},Bl=["value"],Hl={class:"text-right text-xs text-gray-400 dark:text-gray-500"},Gl={class:"text-sm"},Jl={class:"mb-1 flex items-center justify-between"},Ql=["value"],Yl={class:"flex items-center justify-between text-sm"},Zl={class:"font-medium text-gray-700 dark:text-gray-300"},Xl={class:"mb-4"},eo={class:"flex items-center gap-3"},to={class:"text-xs text-gray-500 dark:text-gray-400"},so={key:0,class:"mb-4 overflow-hidden rounded-xl border border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-800/50"},ao={class:"flex items-center justify-between border-b border-gray-200 bg-gray-100 px-3 py-2 dark:border-gray-700 dark:bg-gray-800"},ro={key:0,class:"text-xs text-gray-500 dark:text-gray-500"},lo={class:"max-h-40 overflow-y-auto p-3"},oo={key:0,class:"whitespace-pre-wrap text-sm text-gray-700 dark:text-gray-300"},no={key:0,class:"inline-block h-4 w-1 animate-pulse bg-blue-500"},io={key:1,class:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400"},uo={key:2,class:"text-sm text-red-600 dark:text-red-400"},co={key:1,class:"mb-4 flex items-center justify-center gap-2 text-xs text-gray-500 dark:text-gray-400"},mo={class:"flex items-center justify-end gap-3 border-t border-gray-100 bg-gray-50/80 px-5 py-3 dark:border-gray-800 dark:bg-gray-900/50"},go=["disabled"],xo=["disabled"],yo={__name:"ApiKeyTestModal",props:{show:{type:Boolean,default:!1},apiKeyValue:{type:String,default:""},apiKeyName:{type:String,default:""},serviceType:{type:String,default:"claude",validator:U=>["claude","gemini","openai"].includes(U)}},emits:["close"],setup(U,{emit:K}){const i=U,_=K,g=T("idle"),v=T(""),h=T(""),$=T(0),I=T(null),P=T(null),w=T("claude-sonnet-4-5-20250929"),u=T("hi"),x=T(1e3),f=[{value:100,label:"100"},{value:500,label:"500"},{value:1e3,label:"1000"},{value:2e3,label:"2000"},{value:4096,label:"4096"}],c=T({claude:[],gemini:[],openai:[]}),o=async()=>{try{const r=await Ze();r.success&&r.data&&(c.value={claude:r.data.claude||[],gemini:r.data.gemini||[],openai:r.data.openai||[]})}catch(r){console.error("Failed to load models:",r)}},C=M(()=>{const r={claude:{name:"Claude",endpoint:"/api-key/test",defaultModel:"claude-sonnet-4-5-20250929",displayEndpoint:"/api/v1/messages"},gemini:{name:"Gemini",endpoint:"/api-key/test-gemini",defaultModel:"gemini-2.5-pro",displayEndpoint:"/gemini/v1/models/:model:streamGenerateContent"},openai:{name:"OpenAI (Codex)",endpoint:"/api-key/test-openai",defaultModel:"gpt-5",displayEndpoint:"/openai/responses"}};return r[i.serviceType]||r.claude}),j=M(()=>c.value[i.serviceType]||[]);Ee(()=>{o()});const E=M(()=>i.apiKeyName||"当anterior API Key"),q=M(()=>{const r=i.apiKeyValue;return r?r.length<=10?"****":r.substring(0,6)+"****"+r.substring(r.length-4):""}),F=M(()=>{switch(g.value){case"idle":return"准备就绪";case"testing":return"正en测试...";case"success":return"测试Exitoso";case"error":return"测试Fallido";default:return"DesconocidoEstado"}}),Q=M(()=>{switch(g.value){case"idle":return"点击abajo方按钮开始测试 API Key 连通性";case"testing":return"正en通过 /api 端点发送测试Solicitud";case"success":return"API Key 可以正常访问服务";case"error":return h.value||"无法通过 API Key 访问服务";default:return""}}),W=M(()=>{switch(g.value){case"idle":return"border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-800/50";case"testing":return"border-blue-200 bg-blue-50 dark:border-blue-500/30 dark:bg-blue-900/20";case"success":return"border-green-200 bg-green-50 dark:border-green-500/30 dark:bg-green-900/20";case"error":return"border-red-200 bg-red-50 dark:border-red-500/30 dark:bg-red-900/20";default:return"border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-800/50"}}),H=M(()=>{switch(g.value){case"idle":return"bg-gray-200 dark:bg-gray-700";case"testing":return"bg-blue-100 dark:bg-blue-500/30";case"success":return"bg-green-100 dark:bg-green-500/30";case"error":return"bg-red-100 dark:bg-red-500/30";default:return"bg-gray-200 dark:bg-gray-700"}}),te=M(()=>{switch(g.value){case"idle":return"fa-hourglass-start";case"testing":return"fa-spinner fa-spin";case"success":return"fa-check-circle";case"error":return"fa-exclamation-circle";default:return"fa-question-circle"}}),oe=M(()=>{switch(g.value){case"idle":return"text-gray-500 dark:text-gray-400";case"testing":return"text-blue-500 dark:text-blue-400";case"success":return"text-green-500 dark:text-green-400";case"error":return"text-red-500 dark:text-red-400";default:return"text-gray-500 dark:text-gray-400"}}),ne=M(()=>{switch(g.value){case"idle":return"text-gray-700 dark:text-gray-300";case"testing":return"text-blue-700 dark:text-blue-300";case"success":return"text-green-700 dark:text-green-300";case"error":return"text-red-700 dark:text-red-300";default:return"text-gray-700 dark:text-gray-300"}});async function Y(){if(!i.apiKeyValue)return;g.value="testing",v.value="",h.value="",$.value=0,I.value=Date.now(),P.value&&P.value.abort(),P.value=new AbortController;const r=`${Xe.apiPrefix}/apiStats${C.value.endpoint}`;try{const s=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:i.apiKeyValue,model:w.value,prompt:u.value,maxTokens:x.value}),signal:P.value.signal});if(!s.ok){const B=await s.json().catch(()=>({}));throw new Error(B.message||B.error||`HTTP ${s.status}`)}const m=s.body.getReader(),A=new TextDecoder;let N=!1;for(;!N;){const{done:B,value:de}=await m.read();if(B){N=!0;continue}const ie=A.decode(de).split(`
`);for(const J of ie)if(J.startsWith("data: "))try{const ae=JSON.parse(J.substring(6));X(ae)}catch{}}}catch(s){if(s.name==="AbortError")return;g.value="error",h.value=s.message||"连接Fallido",$.value=Date.now()-I.value}}function X(r){switch(r.type){case"test_start":break;case"content":v.value+=r.text;break;case"message_stop":break;case"test_complete":$.value=Date.now()-I.value,r.success?g.value="success":(g.value="error",h.value=r.error||"测试Fallido");break;case"error":g.value="error",h.value=r.error||"Error desconocido",$.value=Date.now()-I.value;break}}function G(){g.value!=="testing"&&(P.value&&(P.value.abort(),P.value=null),g.value="idle",v.value="",h.value="",$.value=0,_("close"))}return Te(()=>i.show,r=>{r&&(g.value="idle",v.value="",h.value="",$.value=0,w.value=C.value.defaultModel,u.value="hi",x.value=1e3)}),Te(()=>i.serviceType,()=>{w.value=C.value.defaultModel}),De(()=>{P.value&&P.value.abort()}),(r,s)=>(a(),ve(qe,{to:"body"},[U.show?(a(),l("div",jl,[e("div",{class:"absolute inset-0",onClick:G}),e("div",Ll,[e("div",Pl,[e("div",Rl,[e("div",{class:L(["flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl text-white shadow-lg",g.value==="success"?"bg-gradient-to-br from-green-500 to-emerald-500":g.value==="error"?"bg-gradient-to-br from-red-500 to-pink-500":"bg-gradient-to-br from-blue-500 to-indigo-500"])},[e("i",{class:L(["fas",g.value==="idle"?"fa-vial":g.value==="testing"?"fa-spinner fa-spin":g.value==="success"?"fa-check":"fa-times"])},null,2)],2),e("div",null,[s[3]||(s[3]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"}," Prueba de Endpoint de API Key ",-1)),e("p",Ml,n(E.value),1)])]),e("button",{class:"flex h-9 w-9 items-center justify-center rounded-full bg-gray-100 text-gray-500 transition hover:bg-gray-200 hover:text-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-gray-200",disabled:g.value==="testing",onClick:G},s[4]||(s[4]=[e("i",{class:"fas fa-times text-sm"},null,-1)]),8,El)]),e("div",Dl,[e("div",ql,[s[6]||(s[6]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," API Key ",-1)),e("div",Ul,[e("input",{class:"w-full rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 pr-10 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",readonly:"",type:"text",value:q.value},null,8,Nl),s[5]||(s[5]=e("div",{class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400"},[e("i",{class:"fas fa-lock text-xs"})],-1))]),s[7]||(s[7]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," La prueba usará esta API Key para llamar al endpoint /api del servicio actual ",-1))]),e("div",Ol,[e("div",Fl,[s[9]||(s[9]=e("span",{class:"text-gray-500 dark:text-gray-400"},"测试端点",-1)),e("span",Wl,[s[8]||(s[8]=e("i",{class:"fas fa-link"},null,-1)),k(" "+n(C.value.displayEndpoint),1)])]),e("div",zl,[e("div",Vl,[s[10]||(s[10]=e("span",{class:"text-gray-500 dark:text-gray-400"},"测试Modelo",-1)),xe(e("select",{"onUpdate:modelValue":s[0]||(s[0]=m=>w.value=m),class:"rounded-lg border border-gray-200 bg-white px-2 py-1 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300"},[(a(!0),l(Z,null,se(j.value,m=>(a(),l("option",{key:m.value,value:m.value},n(m.label),9,Bl))),128))],512),[[je,w.value]])]),e("div",Hl,n(w.value),1)]),e("div",Gl,[e("div",Jl,[s[11]||(s[11]=e("span",{class:"text-gray-500 dark:text-gray-400"},"最大Salida Token",-1)),xe(e("select",{"onUpdate:modelValue":s[1]||(s[1]=m=>x.value=m),class:"rounded-lg border border-gray-200 bg-white px-2 py-1 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300"},[(a(),l(Z,null,se(f,m=>e("option",{key:m.value,value:m.value},n(m.label),9,Ql)),64))],512),[[je,x.value]])])]),e("div",Yl,[s[12]||(s[12]=e("span",{class:"text-gray-500 dark:text-gray-400"},"测试服务",-1)),e("span",Zl,n(C.value.name),1)])]),e("div",Xl,[s[13]||(s[13]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Prompt ",-1)),xe(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=m=>u.value=m),class:"w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",placeholder:"Ingresa el prompt de prueba...",rows:"2"},null,512),[[Se,u.value]])]),e("div",{class:L(["mb-4 rounded-xl border p-4 transition-all duration-300",W.value])},[e("div",eo,[e("div",{class:L(["flex h-8 w-8 items-center justify-center rounded-lg",H.value])},[e("i",{class:L(["fas text-sm",te.value,oe.value])},null,2)],2),e("div",null,[e("p",{class:L(["font-medium",ne.value])},n(F.value),3),e("p",to,n(Q.value),1)])])],2),g.value!=="idle"?(a(),l("div",so,[e("div",ao,[s[14]||(s[14]=e("span",{class:"text-xs font-medium text-gray-600 dark:text-gray-400"},"AI 响应",-1)),v.value?(a(),l("span",ro,n(v.value.length)+" 字符 ",1)):b("",!0)]),e("div",lo,[v.value?(a(),l("p",oo,[k(n(v.value)+" ",1),g.value==="testing"?(a(),l("span",no)):b("",!0)])):g.value==="testing"?(a(),l("p",io,s[15]||(s[15]=[e("i",{class:"fas fa-circle-notch fa-spin"},null,-1),k(" 等待响应en... ",-1)]))):g.value==="error"&&h.value?(a(),l("p",uo,n(h.value),1)):b("",!0)])])):b("",!0),$.value>0?(a(),l("div",co,[s[16]||(s[16]=e("i",{class:"fas fa-clock"},null,-1)),e("span",null,"耗时 "+n(($.value/1e3).toFixed(2))+" 秒",1)])):b("",!0)]),e("div",mo,[e("button",{class:"rounded-lg border border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm transition hover:bg-gray-50 hover:shadow dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",disabled:g.value==="testing",onClick:G}," Cerrar ",8,go),e("button",{class:L(["flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium shadow-sm transition",g.value==="testing"||!U.apiKeyValue?"cursor-not-allowed bg-gray-200 text-gray-400 dark:bg-gray-700 dark:text-gray-500":"bg-gradient-to-r from-blue-500 to-indigo-500 text-white hover:from-blue-600 hover:to-indigo-600 hover:shadow-md"]),disabled:g.value==="testing"||!U.apiKeyValue,onClick:Y},[e("i",{class:L(["fas",g.value==="testing"?"fa-spinner fa-spin":"fa-play"])},null,2),k(" "+n(g.value==="testing"?"测试en...":g.value==="idle"?"开始测试":"重新测试"),1)],10,xo)])])])):b("",!0)]))}},fo={class:"glass-strong mb-4 rounded-2xl p-3 shadow-xl sm:mb-6 sm:rounded-3xl sm:p-4 md:mb-8 md:p-6"},po={class:"flex flex-col items-center justify-between gap-3 sm:gap-4 md:flex-row"},vo={class:"flex items-center gap-2 md:gap-4"},bo={class:"flex items-center"},ko={key:0,class:"h-8 w-px bg-gradient-to-b from-transparent via-gray-300 to-transparent opacity-50 dark:via-gray-600"},ho={class:"mb-4 sm:mb-6 md:mb-8"},_o={class:"flex justify-center"},wo={class:"inline-flex w-full max-w-2xl flex-wrap justify-center gap-1 rounded-full border border-white/20 bg-white/10 p-1 shadow-lg backdrop-blur-xl sm:w-auto sm:flex-nowrap"},$o={key:0,class:"tab-content"},Co={key:0,class:"mb-4 sm:mb-6 md:mb-8"},To={class:"rounded-xl border border-red-500/30 bg-red-500/20 p-3 text-sm text-red-800 backdrop-blur-sm dark:border-red-500/20 dark:bg-red-500/10 dark:text-red-200 md:p-4 md:text-base"},So={key:1,class:"fade-in"},Ao={class:"glass-strong rounded-2xl p-3 shadow-xl sm:rounded-3xl sm:p-4 md:p-6"},Ko={class:"mb-3 border-b border-gray-200 pb-3 dark:border-gray-700 sm:mb-4 sm:pb-4 md:mb-6 md:pb-6"},Io={class:"flex flex-col items-start justify-between gap-2 sm:gap-3 md:flex-row md:items-center md:gap-4"},jo={class:"flex w-full items-center gap-2 md:w-auto"},Lo=["disabled"],Po=["disabled"],Ro=["disabled"],Mo={key:0,class:"relative"},Eo=["disabled","title"],Do={key:0,class:"absolute right-0 top-full z-50 mt-1 min-w-[140px] overflow-hidden rounded-lg border border-gray-200 bg-white shadow-lg dark:border-gray-700 dark:bg-gray-800"},qo={class:"mb-4 mt-4 grid grid-cols-1 gap-3 sm:mb-6 sm:mt-6 sm:gap-4 md:mb-8 md:mt-8 md:gap-6 xl:grid-cols-2 xl:items-stretch"},Uo={class:"space-y-4 sm:space-y-6"},No={key:1,class:"tab-content"},Oo={class:"glass-strong rounded-3xl shadow-xl"},Fo={key:2,class:"tab-content"},Wo={class:"glass-strong rounded-2xl p-4 shadow-xl sm:rounded-3xl sm:p-6 md:p-8"},zo={class:"mb-4 flex gap-2 border-b border-gray-200 pb-4 dark:border-gray-700 md:mb-6 md:pb-6"},Vo={key:0},Bo={key:0,class:"py-8 text-center"},Ho={key:1},Go={class:"mb-6 rounded-xl bg-blue-50 p-4 dark:bg-blue-900/20"},Jo={class:"text-sm text-blue-700 dark:text-blue-300"},Qo={class:"font-medium"},Yo={class:"space-y-4"},Zo=["disabled"],Xo={key:0,class:"fas fa-spinner fa-spin mr-2"},en={key:1,class:"fas fa-check-circle mr-2"},tn={key:0,class:"mt-6"},sn={class:"flex items-start gap-3"},an={class:"font-medium"},rn={class:"mt-1 text-sm opacity-90"},ln={key:0,class:"mt-2 text-sm"},on={key:0},nn={class:"font-medium"},dn={key:1},un={class:"font-medium"},cn={key:1},mn={key:0,class:"py-8 text-center"},gn={key:1},xn={key:0,class:"py-8 text-center"},yn={key:1,class:"py-8 text-center"},fn={key:2,class:"space-y-3"},pn={class:"flex items-start justify-between gap-4"},vn={class:"min-w-0 flex-1"},bn={class:"mb-1 flex items-center gap-2"},kn={key:0,class:"inline-flex items-center rounded-full bg-red-100 px-2 py-0.5 text-xs font-medium text-red-700 dark:bg-red-900/30 dark:text-red-300"},hn={class:"text-sm text-gray-600 dark:text-gray-300"},_n={key:0},wn={key:1},$n={key:2},Cn={class:"whitespace-nowrap text-right text-xs text-gray-500 dark:text-gray-400"},Tn={class:"mb-4 flex items-center gap-3"},Sn={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},An={class:"mb-4 whitespace-pre-wrap text-sm leading-relaxed text-gray-600 dark:text-gray-300"},Kn={class:"mb-4 flex cursor-pointer items-center gap-2"},Me="apiStatsNoticeRead",In={__name:"ApiStatsView",setup(U){const K=We(),i=ge(),_=et(),g=T("stats"),v=M(()=>_.isDarkMode),{apiKey:h,apiId:$,loading:I,oemLoading:P,error:w,statsPeriod:u,statsData:x,oemSettings:f,multiKeyMode:c}=ce(i),{queryStats:o,switchPeriod:C,loadStatsWithApiId:j,loadOemSettings:E,loadServiceRates:q,loadApiKeyFromStorage:F,reset:Q}=i,W=T(!1),H=T(!1),te=T("claude"),oe=T(!1),ne=T(!1),Y=T("redeem"),X=T(""),G=T(!1),r=T(null),s=T([]),m=T(!1),A=async()=>{var d;if(!X.value.trim()||!$.value)return;G.value=!0,r.value=null;const p=await tt({apiId:$.value,code:X.value.trim()});if(G.value=!1,p.success){const V=((d=p.data)==null?void 0:d.warnings)||[],le=V.length>0;r.value={success:!0,message:le?V.join("; "):"¡Tarjeta de cuota canjeada exitosamente!",data:p.data,hasWarnings:le},X.value="",Re(le?"Canje exitoso (parcialmente truncado)":"Canje exitoso",le?"warning":"success"),j()}else r.value={success:!1,message:p.error||p.message||"Canje fallido"},Re(p.error||p.message||"Canje fallido","error")},N=async()=>{var d;if(!$.value)return;m.value=!0;const p=await st($.value);m.value=!1,p.success&&(s.value=((d=p.data)==null?void 0:d.records)||p.data||[])},B=()=>{g.value="quota",Y.value==="history"&&N()},de=()=>{Y.value="history",N()},re=p=>{if(!p)return[];if(Array.isArray(p))return p;if(typeof p=="string"){if(p==="all")return[];try{const d=JSON.parse(p);return Array.isArray(d)?d:[]}catch{return[]}}return[]},ie=M(()=>{var d;const p=re((d=x.value)==null?void 0:d.permissions);return p.length===0?!0:p.includes("claude")}),J=M(()=>{var d;const p=re((d=x.value)==null?void 0:d.permissions);return p.length===0?!0:p.includes("gemini")}),ae=M(()=>{var d;const p=re((d=x.value)==null?void 0:d.permissions);return p.length===0?!0:p.includes("openai")}),ue=M(()=>ie.value||J.value||ae.value),ye=M(()=>{var V;const p=re((V=x.value)==null?void 0:V.permissions);if(p.length===0)return"Todos los servicios";const d={claude:"Claude",gemini:"Gemini",openai:"OpenAI",droid:"Droid"};return p.map(le=>d[le]||le).join(", ")}),fe=()=>{H.value=!H.value},pe=(p="claude")=>{te.value=p,H.value=!1,W.value=!0},he=()=>{W.value=!1},y=()=>{oe.value=!1,ne.value&&sessionStorage.setItem(Me,"1")},S=()=>{var d;const p=(d=f.value)==null?void 0:d.apiStatsNotice;p!=null&&p.enabled&&(p!=null&&p.content)&&!sessionStorage.getItem(Me)&&(oe.value=!0)},R=p=>{H.value&&!p.target.closest(".relative")&&(H.value=!1)},z=p=>{(p.ctrlKey||p.metaKey)&&p.key==="Enter"&&(!I.value&&h.value.trim()&&o(),p.preventDefault()),p.key==="Escape"&&Q()};return Ee(async()=>{_.initTheme(),await Promise.all([E(),q()]),S();const p=K.query.apiId,d=K.query.apiKey;if(p&&p.match(/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/i)){$.value=p;const V=F();V&&(h.value=V),j()}else if(d&&d.length>10)h.value=d;else{const V=F();V&&V.length>10&&(h.value=V,o())}document.addEventListener("keydown",z),document.addEventListener("click",R)}),De(()=>{document.removeEventListener("keydown",z),document.removeEventListener("click",R)}),Te(h,p=>{p||i.clearData()}),(p,d)=>{var le,Ae;const V=Ve("router-link");return a(),l("div",{class:L(["min-h-screen p-2 sm:p-4 md:p-6",v.value?"gradient-bg-dark":"gradient-bg"])},[e("div",fo,[e("div",po,[ee(rt,{loading:t(P),"logo-src":t(f).siteIconData||t(f).siteIcon,subtitle:g.value==="stats"?"Estadísticas de API Key":g.value==="quota"?"Tarjetas de Cuota":"Tutoriales de Uso",title:t(f).siteName},null,8,["loading","logo-src","subtitle","title"]),e("div",vo,[e("div",bo,[ee(lt,{mode:"dropdown"})]),t(f).ldapEnabled||t(f).showAdminButton!==!1?(a(),l("div",ko)):b("",!0),t(f).ldapEnabled?(a(),ve(V,{key:1,class:"user-login-button flex items-center gap-2 rounded-2xl px-4 py-2 text-white transition-all duration-300 md:px-5 md:py-2.5",to:"/user-login"},{default:_e(()=>d[14]||(d[14]=[e("i",{class:"fas fa-user text-sm md:text-base"},null,-1),e("span",{class:"text-xs font-semibold tracking-wide md:text-sm"},"Iniciar Sesión",-1)])),_:1,__:[14]})):b("",!0),t(f).showAdminButton!==!1?(a(),ve(V,{key:2,class:"admin-button-refined flex items-center gap-2 rounded-2xl px-4 py-2 transition-all duration-300 md:px-5 md:py-2.5",to:"/dashboard"},{default:_e(()=>d[15]||(d[15]=[e("i",{class:"fas fa-shield-alt text-sm md:text-base"},null,-1),e("span",{class:"text-xs font-semibold tracking-wide md:text-sm"},"Panel de Administración",-1)])),_:1,__:[15]})):b("",!0)])])]),e("div",ho,[e("div",_o,[e("div",wo,[e("button",{class:L(["tab-pill-button",g.value==="stats"?"active":""]),onClick:d[0]||(d[0]=D=>g.value="stats")},d[16]||(d[16]=[e("i",{class:"fas fa-chart-line mr-1 md:mr-2"},null,-1),e("span",{class:"text-sm md:text-base"},"Consulta de Estadísticas",-1)]),2),e("button",{class:L(["tab-pill-button",g.value==="quota"?"active":""]),onClick:B},d[17]||(d[17]=[e("i",{class:"fas fa-ticket-alt mr-1 md:mr-2"},null,-1),e("span",{class:"text-sm md:text-base"},"Tarjetas de Cuota",-1)]),2),e("button",{class:L(["tab-pill-button",g.value==="tutorial"?"active":""]),onClick:d[1]||(d[1]=D=>g.value="tutorial")},d[18]||(d[18]=[e("i",{class:"fas fa-graduation-cap mr-1 md:mr-2"},null,-1),e("span",{class:"text-sm md:text-base"},"Tutoriales de Uso",-1)]),2)])])]),g.value==="stats"?(a(),l("div",$o,[ee(At),t(w)?(a(),l("div",Co,[e("div",To,[d[19]||(d[19]=e("i",{class:"fas fa-exclamation-triangle mr-2"},null,-1)),k(" "+n(t(w)),1)])])):b("",!0),t(x)?(a(),l("div",So,[e("div",Ao,[e("div",Ko,[e("div",Io,[d[27]||(d[27]=e("div",{class:"flex items-center gap-2 md:gap-3"},[e("i",{class:"fas fa-clock text-base text-blue-500 md:text-lg"}),e("span",{class:"text-base font-medium text-gray-700 dark:text-gray-200 md:text-lg"},"Rango de tiempo estadístico")],-1)),e("div",jo,[e("button",{class:L(["flex flex-1 items-center justify-center gap-1 px-4 py-2 text-xs font-medium md:flex-none md:gap-2 md:px-6 md:text-sm",["period-btn",{active:t(u)==="daily"}]]),disabled:t(I),onClick:d[2]||(d[2]=D=>t(C)("daily"))},d[20]||(d[20]=[e("i",{class:"fas fa-calendar-day text-xs md:text-sm"},null,-1),k(" Hoy ",-1)]),10,Lo),e("button",{class:L(["flex flex-1 items-center justify-center gap-1 px-4 py-2 text-xs font-medium md:flex-none md:gap-2 md:px-6 md:text-sm",["period-btn",{active:t(u)==="monthly"}]]),disabled:t(I),onClick:d[3]||(d[3]=D=>t(C)("monthly"))},d[21]||(d[21]=[e("i",{class:"fas fa-calendar-alt text-xs md:text-sm"},null,-1),k(" Este Mes ",-1)]),10,Po),e("button",{class:L(["flex flex-1 items-center justify-center gap-1 px-4 py-2 text-xs font-medium md:flex-none md:gap-2 md:px-6 md:text-sm",["period-btn",{active:t(u)==="alltime"}]]),disabled:t(I),onClick:d[4]||(d[4]=D=>t(C)("alltime"))},d[22]||(d[22]=[e("i",{class:"fas fa-infinity text-xs md:text-sm"},null,-1),k(" Todo ",-1)]),10,Ro),t(c)?b("",!0):(a(),l("div",Mo,[e("button",{class:L(["test-btn flex items-center justify-center gap-1 px-4 py-2 text-xs font-medium md:gap-2 md:px-6 md:text-sm",ue.value?"":"cursor-not-allowed opacity-50"]),disabled:t(I)||!ue.value,title:ue.value?"Probar API":`Servicios disponibles de esta Key: ${ye.value}`,onClick:fe},d[23]||(d[23]=[e("i",{class:"fas fa-vial text-xs md:text-sm"},null,-1),k(" Probar ",-1),e("i",{class:"fas fa-chevron-down ml-1 text-xs"},null,-1)]),10,Eo),H.value?(a(),l("div",Do,[ie.value?(a(),l("button",{key:0,class:"flex w-full items-center gap-2 px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-gray-700",onClick:d[5]||(d[5]=D=>pe("claude"))},d[24]||(d[24]=[e("i",{class:"fas fa-robot text-orange-500"},null,-1),k(" Claude ",-1)]))):b("",!0),J.value?(a(),l("button",{key:1,class:"flex w-full items-center gap-2 px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-gray-700",onClick:d[6]||(d[6]=D=>pe("gemini"))},d[25]||(d[25]=[e("i",{class:"fas fa-gem text-blue-500"},null,-1),k(" Gemini ",-1)]))):b("",!0),ae.value?(a(),l("button",{key:2,class:"flex w-full items-center gap-2 px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-gray-700",onClick:d[7]||(d[7]=D=>pe("openai"))},d[26]||(d[26]=[e("i",{class:"fas fa-code text-green-500"},null,-1),k(" Codex ",-1)]))):b("",!0)])):b("",!0)]))])])]),ee(Gs),e("div",qo,[ee(ma,{class:"h-full"}),t(c)?(a(),ve(qr,{key:0,class:"h-full"})):(a(),ve(wr,{key:1,class:"h-full"}))]),ee(Il,{class:"mb-4 sm:mb-6"}),e("div",Uo,[ee(we,{period:"daily"}),ee(we,{period:"monthly"}),ee(we,{period:"alltime"})])])])):b("",!0)])):b("",!0),g.value==="tutorial"?(a(),l("div",No,[e("div",Oo,[ee(nt)])])):b("",!0),g.value==="quota"?(a(),l("div",Fo,[e("div",Wo,[e("div",zo,[e("button",{class:L(["rounded-lg px-4 py-2 text-sm font-medium transition-all",Y.value==="redeem"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:d[8]||(d[8]=D=>Y.value="redeem")},d[28]||(d[28]=[e("i",{class:"fas fa-ticket-alt mr-2"},null,-1),k(" Canjear Tarjeta de Cuota ",-1)]),2),e("button",{class:L(["rounded-lg px-4 py-2 text-sm font-medium transition-all",Y.value==="history"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:de},d[29]||(d[29]=[e("i",{class:"fas fa-history mr-2"},null,-1),k(" Historial de Canjes ",-1)]),2)]),Y.value==="redeem"?(a(),l("div",Vo,[t($)?(a(),l("div",Ho,[e("div",Go,[e("p",Jo,[d[31]||(d[31]=e("i",{class:"fas fa-info-circle mr-2"},null,-1)),d[32]||(d[32]=k(" API Key actual: ",-1)),e("span",Qo,n(((le=t(x))==null?void 0:le.name)||t($)),1)])]),e("div",Yo,[e("div",null,[d[33]||(d[33]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Número de Tarjeta de Cuota ",-1)),xe(e("input",{"onUpdate:modelValue":d[10]||(d[10]=D=>X.value=D),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 placeholder-gray-400 transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 dark:placeholder-gray-500",placeholder:"Ingrese el número de tarjeta de cuota",type:"text",onKeyup:$e(A,["enter"])},null,544),[[Se,X.value]])]),e("button",{class:"w-full rounded-xl bg-gradient-to-r from-green-500 to-emerald-500 px-6 py-3 font-medium text-white transition-all hover:from-green-600 hover:to-emerald-600 disabled:cursor-not-allowed disabled:opacity-50",disabled:!X.value.trim()||G.value,onClick:A},[G.value?(a(),l("i",Xo)):(a(),l("i",en)),k(" "+n(G.value?"Canjeando...":"Canjear Ahora"),1)],8,Zo)]),r.value?(a(),l("div",tn,[e("div",{class:L(["rounded-xl p-4",r.value.success?r.value.hasWarnings?"bg-yellow-50 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-300":"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-300":"bg-red-50 text-red-700 dark:bg-red-900/20 dark:text-red-300"])},[e("div",sn,[e("i",{class:L(["mt-0.5 text-lg",r.value.success?r.value.hasWarnings?"fas fa-exclamation-triangle":"fas fa-check-circle":"fas fa-times-circle"])},null,2),e("div",null,[e("p",an,n(r.value.success?r.value.hasWarnings?"Canje exitoso (parcialmente truncado)":"Canje exitoso":"Canje fallido"),1),e("p",rn,n(r.value.message),1),r.value.success&&r.value.data?(a(),l("div",ln,[r.value.data.quotaAdded?(a(),l("p",on,[d[34]||(d[34]=k(" Cuota aumentada: ",-1)),e("span",nn,"$"+n(r.value.data.quotaAdded),1)])):b("",!0),r.value.data.timeAdded?(a(),l("p",dn,[d[35]||(d[35]=k(" Validez extendida: ",-1)),e("span",un,n(r.value.data.timeAdded)+n(r.value.data.timeUnit==="days"?" días":r.value.data.timeUnit==="hours"?" horas":" meses"),1)])):b("",!0)])):b("",!0)])])],2)])):b("",!0)])):(a(),l("div",Bo,[d[30]||(d[30]=e("div",{class:"mb-4 text-gray-500 dark:text-gray-400"},[e("i",{class:"fas fa-key mb-4 block text-4xl opacity-50"}),e("p",null,'Primero ingrese su API Key en la página de "Consulta de Estadísticas"')],-1)),e("button",{class:"rounded-xl bg-gradient-to-r from-blue-500 to-cyan-500 px-6 py-2.5 font-medium text-white transition-all hover:from-blue-600 hover:to-cyan-600",onClick:d[9]||(d[9]=D=>g.value="stats")}," Ir a Ingresar API Key ")]))])):b("",!0),Y.value==="history"?(a(),l("div",cn,[t($)?(a(),l("div",gn,[m.value?(a(),l("div",xn,d[37]||(d[37]=[e("i",{class:"fas fa-spinner fa-spin text-2xl text-gray-400"},null,-1),e("p",{class:"mt-2 text-gray-500 dark:text-gray-400"},"Cargando...",-1)]))):s.value.length===0?(a(),l("div",yn,d[38]||(d[38]=[e("i",{class:"fas fa-inbox text-4xl text-gray-300 dark:text-gray-600"},null,-1),e("p",{class:"mt-2 text-gray-500 dark:text-gray-400"},"No hay registros de canjes",-1)]))):(a(),l("div",fn,[(a(!0),l(Z,null,se(s.value,D=>(a(),l("div",{key:D.id,class:"rounded-xl border border-gray-200 bg-white p-4 dark:border-gray-700 dark:bg-gray-800"},[e("div",pn,[e("div",vn,[e("div",bn,[e("span",{class:L(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium",D.cardType==="quota"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":D.cardType==="time"?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300"])},n(D.cardType==="quota"?"Tarjeta de Cuota":D.cardType==="time"?"Tarjeta de Tiempo":"Tarjeta Combinada"),3),D.status==="revoked"?(a(),l("span",kn," Revocado ")):b("",!0)]),e("p",hn,[D.quotaAdded?(a(),l("span",_n,"Cuota +$"+n(D.quotaAdded),1)):b("",!0),D.quotaAdded&&D.timeAdded?(a(),l("span",wn," · ")):b("",!0),D.timeAdded?(a(),l("span",$n,"Validez +"+n(D.timeAmount)+n(D.timeUnit==="days"?" días":D.timeUnit==="hours"?" horas":" meses"),1)):b("",!0)])]),e("div",Cn,n(t(at)(D.redeemedAt)),1)])]))),128))]))])):(a(),l("div",mn,[d[36]||(d[36]=e("div",{class:"mb-4 text-gray-500 dark:text-gray-400"},[e("i",{class:"fas fa-key mb-4 block text-4xl opacity-50"}),e("p",null,'Primero ingrese su API Key en la página de "Consulta de Estadísticas"')],-1)),e("button",{class:"rounded-xl bg-gradient-to-r from-blue-500 to-cyan-500 px-6 py-2.5 font-medium text-white transition-all hover:from-blue-600 hover:to-cyan-600",onClick:d[11]||(d[11]=D=>g.value="stats")}," Ir a Ingresar API Key ")]))])):b("",!0)])])):b("",!0),ee(yo,{"api-key-name":((Ae=t(x))==null?void 0:Ae.name)||"","api-key-value":t(h),"service-type":te.value,show:W.value,onClose:he},null,8,["api-key-name","api-key-value","service-type","show"]),(a(),ve(qe,{to:"body"},[ee(ze,{name:"fade"},{default:_e(()=>{var D,Ke;return[oe.value?(a(),l("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4 backdrop-blur-sm",onClick:Ce(y,["self"])},[e("div",{class:"w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl dark:bg-gray-800",onClick:d[13]||(d[13]=Ce(()=>{},["stop"]))},[e("div",Tn,[d[39]||(d[39]=e("div",{class:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-amber-500 to-orange-600 text-white"},[e("i",{class:"fas fa-bell"})],-1)),e("h3",Sn,n(((D=t(f).apiStatsNotice)==null?void 0:D.title)||"Notificación"),1)]),e("p",An,n((Ke=t(f).apiStatsNotice)==null?void 0:Ke.content),1),e("label",Kn,[xe(e("input",{"onUpdate:modelValue":d[12]||(d[12]=Ne=>ne.value=Ne),class:"h-4 w-4 rounded border-gray-300 text-blue-500 focus:ring-blue-500",type:"checkbox"},null,512),[[Be,ne.value]]),d[40]||(d[40]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"No mostrar de nuevo en esta sesión",-1))]),e("button",{class:"w-full rounded-xl bg-gradient-to-r from-blue-500 to-cyan-500 px-4 py-2.5 font-medium text-white transition-all hover:from-blue-600 hover:to-cyan-600",onClick:y}," Entendido ")])])):b("",!0)]}),_:1})]))],2)}}},Un=me(In,[["__scopeId","data-v-b4995185"]]);export{Un as default};
